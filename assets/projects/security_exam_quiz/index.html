<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security+ SY0-701 Quiz App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
        }
        .heartbeat {
            animation: heartbeat 1.5s ease-in-out infinite both;
        }
        @keyframes heartbeat {
            from { transform: scale(1); transform-origin: center center; animation-timing-function: ease-out; }
            10% { transform: scale(0.91); animation-timing-function: ease-in; }
            17% { transform: scale(0.98); animation-timing-function: ease-out; }
            33% { transform: scale(0.87); animation-timing-function: ease-in; }
            45% { transform: scale(1); animation-timing-function: ease-out; }
        }
        .quiz-option {
            transition: all 0.2s ease-in-out;
        }
        .quiz-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .quiz-option.selected {
            background-color: #3b82f6;
            color: white;
            border-color: #2563eb;
        }
        .quiz-option.correct-answer {
            background-color: #16a34a; /* green-600 */
            color: white;
            border-color: #15803d; /* green-700 */
        }
        .quiz-option.incorrect-answer {
            background-color: #dc2626; /* red-600 */
            color: white;
            border-color: #b91c1c; /* red-700 */
        }
        .quiz-option.user-selected {
            outline: 2px solid #2563eb; /* blue-600 */
            outline-offset: 2px;
        }
        .explanation-box {
            background-color: #f3f4f6; /* gray-100 */
            border-left: 4px solid #6b7280; /* gray-500 */
            padding: 1rem;
            margin-top: 1.5rem;
            border-radius: 0.25rem;
        }
        /* Loading Spinner */
        #loader {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Loading Spinner Overlay -->
    <div id="loader-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100]">
        <div id="loader"></div>
    </div>

    <!-- Main Container -->
    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800">CompTIA Security+ SY0-701 Quiz</h1>
            <p class="text-lg text-gray-600 mt-2">Test your knowledge and prepare for the exam.</p>
        </header>

        <!-- Quiz Setup Section -->
        <div id="setup-section" class="bg-white p-6 rounded-lg shadow-lg mb-8">
            <h2 class="text-2xl font-bold mb-4">Exam Configuration</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label for="domain-select" class="block text-sm font-medium text-gray-700 mb-2">Select Domain:</label>
                    <select id="domain-select" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="all">All Domains</option>
                        <!-- Domains will be populated by JS -->
                    </select>
                </div>
                <div>
                    <label for="question-count" class="block text-sm font-medium text-gray-700 mb-2">Number of Questions:</label>
                    <select id="question-count" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="30">30 Questions</option>
                        <option value="60">60 Questions</option>
                        <option value="90">90 Questions</option>
                        <option value="120">120 Questions</option>
                        <option value="150">150 Questions</option>
                        <option value="180">All 180 Questions</option>
                    </select>
                </div>
                <div>
                    <label for="exam-type" class="block text-sm font-medium text-gray-700 mb-2">Exam Type:</label>
                    <select id="exam-type" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="practice">Practice Mode</option>
                        <option value="timed">Timed Mode (1 min/question)</option>
                    </select>
                </div>
            </div>
            <div class="mt-6 text-center">
                <button id="start-exam" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition duration-300 shadow-md text-base">Start Exam</button>
            </div>
        </div>

        <!-- Quiz Section -->
        <div id="quiz-section" class="hidden bg-white p-6 rounded-lg shadow-lg mb-8">
            <div class="flex justify-between items-center mb-4">
                <div id="progress-indicator" class="text-sm font-medium text-gray-600"></div>
                <div id="timer" class="text-xl font-bold text-red-600"></div>
            </div>
            <div id="question-container" class="min-h-[450px]"></div>
            <div class="mt-6 flex justify-between items-center">
                <button id="prev-question" class="bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg hover:bg-gray-400 transition duration-300">Previous</button>
                <button id="next-question" class="bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition duration-300">Next</button>
                <button id="submit-exam" class="hidden bg-green-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-green-700 transition duration-300">Submit</button>
            </div>
        </div>
        
        <!-- Review Section -->
        <div id="review-section" class="hidden bg-white p-6 rounded-lg shadow-lg mb-8">
            <h2 class="text-3xl font-bold mb-4 text-center">Review Your Answers</h2>
            <div id="review-container" class="min-h-[500px]"></div>
            <div class="mt-6 flex justify-between items-center">
                <button id="prev-review-question" class="bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg hover:bg-gray-400 transition duration-300">Previous</button>
                <div id="review-progress-indicator" class="text-sm font-medium text-gray-600"></div>
                <button id="next-review-question" class="bg-blue-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-600 transition duration-300">Next</button>
            </div>
             <div class="mt-6 text-center">
                <button id="back-to-results" class="bg-gray-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-700 transition duration-300">Back to Results</button>
            </div>
        </div>


        <!-- Results Section -->
        <div id="results-section" class="hidden bg-white p-6 rounded-lg shadow-lg text-center">
            <h2 class="text-3xl font-bold mb-4">Exam Results</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-lg">
                <div class="p-4 bg-gray-50 rounded-lg">
                    <p class="font-bold">Score:</p>
                    <p id="score" class="text-2xl font-bold text-green-600"></p>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg">
                    <p class="font-bold">Percentage:</p>
                    <p id="percentage" class="text-2xl font-bold text-blue-600"></p>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg">
                    <p class="font-bold">Time Taken:</p>
                    <p id="time-taken" class="text-2xl font-bold text-purple-600"></p>
                </div>
            </div>
            <div class="mt-8 flex justify-center gap-4">
                 <button id="review-exam" class="bg-purple-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-purple-700 transition duration-300">Review Answers</button>
                 <button id="restart-exam" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition duration-300">Take Another Exam</button>
            </div>
        </div>

        <!-- History Table Section -->
        <div id="history-section" class="bg-white p-6 rounded-lg shadow-lg mt-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Exam History</h2>
                <div class="flex items-center gap-2">
                    <button id="download-csv" class="bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition duration-300 text-sm"><i class="fas fa-download mr-1"></i> CSV</button>
                    <button id="download-json" class="bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition duration-300 text-sm"><i class="fas fa-download mr-1"></i> JSON</button>
                    <button id="reset-history" class="bg-red-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-700 transition duration-300 text-sm"><i class="fas fa-trash-alt mr-1"></i> Reset</button>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-200">
                        <tr>
                            <th class="py-2 px-4 border-b">Seed</th>
                            <th class="py-2 px-4 border-b">Date</th>
                            <th class="py-2 px-4 border-b">Score</th>
                            <th class="py-2 px-4 border-b">Percentage</th>
                            <th class="py-2 px-4 border-b">Time Taken</th>
                        </tr>
                    </thead>
                    <tbody id="history-table-body">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Floating Support Icon -->
    <div id="support-icon" class="fixed bottom-8 right-8 cursor-pointer heartbeat z-50">
        <a href="https://buymeacoffee.com/gourabdg" target="_blank" class="block w-16 h-16 bg-red-500 rounded-full flex items-center justify-center shadow-lg text-white">
            <i class="fas fa-heart text-2xl"></i>
        </a>
    </div>

    <!-- Support Modal -->
    <div id="support-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-sm mx-auto">
            <h3 class="text-2xl font-bold mb-4">Support the Developer!</h3>
            <p class="mb-6 text-gray-700">If you find this quiz app helpful, please consider supporting my work. It helps me create more tools like this for the community.</p>
            <a href="https://buymeacoffee.com/gourabdg" target="_blank" class="bg-yellow-400 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-yellow-500 transition duration-300 block mb-3">
                <i class="fas fa-coffee mr-2"></i>Buy me a coffee
            </a>
            <button id="skip-support" class="bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg hover:bg-gray-400 transition duration-300 w-full">Skip to Exam</button>
        </div>
    </div>
    
    <!-- Reset Confirmation Modal -->
    <div id="reset-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-sm mx-auto">
            <h3 class="text-2xl font-bold mb-4">Confirm Reset</h3>
            <p class="mb-6 text-gray-700">Are you sure you want to delete all exam history? This action cannot be undone.</p>
            <div class="flex justify-center gap-4">
                <button id="confirm-reset-btn" class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition duration-300">Reset</button>
                <button id="cancel-reset-btn" class="bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg hover:bg-gray-400 transition duration-300">Cancel</button>
            </div>
        </div>
    </div>
    
    <script id="questions-data" type="application/json">
    [
        {
            "question": "Which of the following ensures that a sender cannot deny sending a message?",
            "options": ["Encryption", "Hashing", "Digital Signature", "Symmetric Key Exchange"],
            "answer": "Digital Signature",
            "domain": "General Security Concepts",
            "explanation": "A digital signature provides non-repudiation, which means the sender cannot deny having sent the message. It uses the sender's private key to sign the message, and anyone with the public key can verify it."
        },
        {
            "question": "Which type of threat actor is MOST likely to have the greatest resources and patience for an extended attack?",
            "options": ["Insider", "Nation-State", "Script Kiddie", "Hacktivist"],
            "answer": "Nation-State",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Nation-state actors are sponsored by governments and have significant financial and technical resources, allowing them to conduct long-term, sophisticated campaigns (APTs)."
        },
        {
            "question": "What type of attack involves inserting malicious code into a legitimate web application to steal information from users?",
            "options": ["Phishing", "SQL Injection", "Cross-Site Scripting (XSS)", "DNS Spoofing"],
            "answer": "Cross-Site Scripting (XSS)",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Cross-Site Scripting (XSS) is a web security vulnerability that allows an attacker to inject malicious scripts into content from otherwise trusted websites, which then execute on the victim's browser."
        },
        {
            "question": "A company needs to prevent unauthorized devices from connecting to its internal network. What technology should be used?",
            "options": ["Firewall", "VPN", "NAC (Network Access Control)", "IDS"],
            "answer": "NAC (Network Access Control)",
            "domain": "Security Architecture",
            "explanation": "Network Access Control (NAC) solutions are designed to enforce security policies on all devices seeking to access network resources, thereby preventing unauthorized devices from connecting."
        },
        {
            "question": "Which backup type saves only the changes made since the last full backup?",
            "options": ["Incremental", "Differential", "Full", "Snapshot"],
            "answer": "Differential",
            "domain": "Security Operations",
            "explanation": "A differential backup copies all files that have changed since the last full backup. This means restore times are faster than incremental, as only the last full backup and the latest differential backup are needed."
        },
        {
            "question": "What control type is a biometric fingerprint scanner?",
            "options": ["Technical", "Administrative", "Physical", "Compensating"],
            "answer": "Physical",
            "domain": "General Security Concepts",
            "explanation": "A biometric scanner is a physical control because it is a tangible device used to control physical access to a location or system."
        },
        {
            "question": "Which wireless security protocol is the most secure for corporate environments?",
            "options": ["WEP", "WPA", "WPA2-PSK", "WPA3-Enterprise"],
            "answer": "WPA3-Enterprise",
            "domain": "Security Architecture",
            "explanation": "WPA3-Enterprise provides the highest level of wireless security by using 802.1X authentication, which requires each user to authenticate with unique credentials, typically via a RADIUS server."
        },
        {
            "question": "Which of the following would BEST help mitigate risks associated with phishing attacks?",
            "options": ["IDS", "Security Awareness Training", "Firewall Rules", "Password Complexity Requirements"],
            "answer": "Security Awareness Training",
            "domain": "Security Program Management and Oversight",
            "explanation": "While technical controls help, the most effective defense against phishing is educating users. Security awareness training teaches them how to recognize and report phishing attempts."
        },
        {
            "question": "Which risk response involves buying cyber insurance?",
            "options": ["Accept", "Mitigate", "Transfer", "Avoid"],
            "answer": "Transfer",
            "domain": "Security Program Management and Oversight",
            "explanation": "Risk transference is the practice of passing a risk to a third party. Buying insurance is a classic example of transferring financial risk."
        },
        {
            "question": "Which concept is being applied when access to files is based on job roles such as HR, IT, or Accounting?",
            "options": ["MAC", "DAC", "RBAC", "ABAC"],
            "answer": "RBAC",
            "domain": "General Security Concepts",
            "explanation": "Role-Based Access Control (RBAC) assigns permissions to users based on their role within an organization, simplifying the management of user access rights."
        },
        {
            "question": "What type of malware disguises itself as a legitimate program but delivers a malicious payload?",
            "options": ["Worm", "Ransomware", "Trojan", "Rootkit"],
            "answer": "Trojan",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "A Trojan, or Trojan horse, is a type of malware that is often disguised as legitimate software. Trojans can be used by cyber-thieves and hackers trying to gain access to users' systems."
        },
        {
            "question": "Which process helps ensure that only needed ports and services are running on a server?",
            "options": ["Network segmentation", "Baseline configuration", "Change management", "Hardening"],
            "answer": "Hardening",
            "domain": "Security Operations",
            "explanation": "System hardening is the process of securing a system by reducing its surface of vulnerability. This includes disabling unnecessary ports and services to minimize potential attack vectors."
        },
        {
            "question": "A database administrator is setting access so that users only have permission to view certain data. Which principle is being applied?",
            "options": ["Separation of Duties", "Need-to-Know", "Non-repudiation", "Risk Transference"],
            "answer": "Need-to-Know",
            "domain": "General Security Concepts",
            "explanation": "The principle of need-to-know restricts access to sensitive information to only those individuals who require it to perform their job duties."
        },
        {
            "question": "What is the primary purpose of a honeypot?",
            "options": ["Encrypt sensitive data", "Divert attackers away from real systems", "Patch vulnerabilities", "Enforce firewall rules"],
            "answer": "Divert attackers away from real systems",
            "domain": "Security Operations",
            "explanation": "A honeypot is a decoy computer system designed to attract and trap attackers, diverting them from legitimate targets and allowing security teams to study their methods."
        },
        {
            "question": "During which incident response phase would you isolate a compromised server?",
            "options": ["Recovery", "Containment", "Lessons Learned", "Identification"],
            "answer": "Containment",
            "domain": "Security Operations",
            "explanation": "The containment phase of incident response focuses on limiting the damage of an attack. Isolating a compromised server from the network prevents the attack from spreading to other systems."
        },
        {
            "question": "A company is using older operating systems for their web servers and are concerned of their stability during periods of high use. Which of the following should the company use to maximize the uptime and availability of this service?",
            "options": ["Cold site", "UPS", "Redundant routers", "Load balancer"],
            "answer": "Load balancer",
            "domain": "Security Architecture",
            "explanation": "A load balancer distributes network traffic across multiple servers to ensure no single server becomes overwhelmed, thereby improving availability and responsiveness."
        },
        {
            "question": "A system administrator would like to segment the network to give the marketing, accounting, and manufacturing departments their own private network. Which of the following should be configured on this network?",
            "options": ["VPN", "RBAC", "VLAN", "SDN"],
            "answer": "VLAN",
            "domain": "Security Architecture",
            "explanation": "A Virtual LAN (VLAN) allows a network administrator to create logical subgroupings of devices on the same physical network, effectively segmenting them from each other for security and management purposes."
        },
        {
            "question": "Which of the following is used to describe how cautious an organization might be to taking a specific risk?",
            "options": ["Risk appetite", "Risk register", "Risk transfer", "Risk reporting"],
            "answer": "Risk appetite",
            "domain": "Security Program Management and Oversight",
            "explanation": "Risk appetite is the level of risk an organization is willing to accept in pursuit of its objectives, before action is deemed necessary to reduce the risk."
        },
        {
            "question": "A security administrator has found a keylogger installed in an update of the company's accounting software. Which of the following would prevent the transmission of the collected logs?",
            "options": ["Prevent the installation of all software", "Block all unknown outbound network traffic at the Internet firewall", "Install host-based anti-virus software", "Scan all incoming email attachments at the email gateway"],
            "answer": "Block all unknown outbound network traffic at the Internet firewall",
            "domain": "Security Operations",
            "explanation": "Keyloggers need to send the data they collect back to the attacker. Blocking unknown outbound traffic at the firewall (an egress filtering policy) is an effective way to prevent this data exfiltration."
        },
        {
            "question": "An attacker has gained access to an application through the use of packet captures. Which of the following would be MOST likely used by the attacker?",
            "options": ["Overflow", "Forgery", "Replay", "Injection"],
            "answer": "Replay",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "A replay attack involves capturing network packets and then re-transmitting them to impersonate the original user or repeat a transaction. This is a common attack when authentication tokens are captured."
        },
        {
            "question": "A company must comply with legal requirements for storing customer data in the same country as the customer's mailing address. Which of the following would describe this requirement?",
            "options": ["Geographic dispersion", "Least privilege", "Data sovereignty", "Exfiltration"],
            "answer": "Data sovereignty",
            "domain": "Security Program Management and Oversight",
            "explanation": "Data sovereignty is the concept that data is subject to the laws and legal jurisdiction of the country in which it is located."
        },
        {
            "question": "What is the key difference between a worm and a virus?",
            "options": ["What operating system they run on", "How they spread", "What their potential impact is", "The number of infections"],
            "answer": "How they spread",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "The primary difference is that a virus requires user interaction to spread (e.g., opening an infected file), while a worm can self-replicate and spread across networks without any user action."
        },
        {
            "question": "An organization has identified a security breach and has removed the affected servers from the network. Which of the following is the NEXT step in the incident response process?",
            "options": ["Eradication", "Preparation", "Recovery", "Detection"],
            "answer": "Eradication",
            "domain": "Security Operations",
            "explanation": "After containing an incident (e.g., by taking servers offline), the next phase is eradication, which involves removing the malware or threat from the affected systems completely."
        },
        {
            "question": "A security administrator has configured a virtual machine in a screened subnet with a guest login account and no password. Which of the following would be the MOST likely reason for this configuration?",
            "options": ["The server is a honeypot for attracting potential attackers", "The server is a cloud storage service for remote users", "The server will be used as a VPN concentrator", "The server is a development sandbox for third-party programming projects"],
            "answer": "The server is a honeypot for attracting potential attackers",
            "domain": "Security Operations",
            "explanation": "A system that is intentionally left insecure and placed in a monitored environment (like a screened subnet or DMZ) is characteristic of a honeypot, designed to lure and analyze attackers."
        },
        {
            "question": "A security administrator needs to block users from visiting websites hosting malicious software. Which of the following would be the BEST way to control this access?",
            "options": ["Honeynet", "Data masking", "DNS filtering", "Data loss prevention"],
            "answer": "DNS filtering",
            "domain": "Security Architecture",
            "explanation": "DNS filtering services prevent users from connecting to known malicious websites by blocking the DNS resolution for those domains at the network level."
        },
        {
            "question": "A user connects to a third-party website and receives this message: 'Your connection is not private. NET::ERR_CERT_INVALID'. Which of the following attacks would be the MOST likely reason for this message?",
            "options": ["Brute force", "DoS", "On-path", "Deauthentication"],
            "answer": "On-path",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "An on-path (formerly man-in-the-middle) attack can intercept traffic and present a fraudulent SSL/TLS certificate, causing the browser to display a certificate invalid error."
        },
        {
            "question": "What kind of security control is associated with a login banner?",
            "options": ["Preventive", "Deterrent", "Corrective", "Detective"],
            "answer": "Deterrent",
            "domain": "General Security Concepts",
            "explanation": "A login banner that warns against unauthorized access acts as a deterrent control. It discourages potential attackers by reminding them of the legal consequences."
        },
        {
            "question": "Which of the following describes two-factor authentication?",
            "options": ["A printer uses a password and a PIN", "The door to a building requires a fingerprint scan", "An application requires a pseudo-random code", "A Windows Domain requires a password and smart card"],
            "answer": "A Windows Domain requires a password and smart card",
            "domain": "General Security Concepts",
            "explanation": "Two-factor authentication requires two different types of authentication factors. A password is 'something you know' and a smart card is 'something you have', satisfying the requirement."
        },
        {
            "question": "A Linux administrator is downloading an updated version of her Linux distribution. The download site shows a link to the ISO and a SHA256 hash value. Which of these would describe the use of this hash value?",
            "options": ["Verifies that the file was not corrupted during the file transfer", "Provides a key for decrypting the ISO after download", "Authenticates the site as an official ISO distribution site", "Confirms that the file does not contain any malware"],
            "answer": "Verifies that the file was not corrupted during the file transfer",
            "domain": "General Security Concepts",
            "explanation": "A hash value provides integrity. By calculating the hash of the downloaded file and comparing it to the one provided on the website, the administrator can verify that the file has not been altered or corrupted."
        },
        {
            "question": "Which of the following would be the main reasons why a system administrator would use a TPM when configuring full disk encryption? (Select TWO)",
            "options": ["Allows the encryption of multiple volumes", "Uses burned-in cryptographic keys", "Stores certificates in a hardware security module", "Includes built-in protections against brute-force attacks"],
            "answer": ["Uses burned-in cryptographic keys", "Includes built-in protections against brute-force attacks"],
            "domain": "Security Architecture",
            "explanation": "A Trusted Platform Module (TPM) is a hardware-based security solution. It securely stores cryptographic keys (burned into the hardware) and can protect against brute-force attacks on disk encryption keys."
        },
        {
            "question": "An attacker is using a tool to intercept and modify traffic between a user and a web server. This is an example of what kind of attack?",
            "options": ["Phishing", "Man-in-the-Middle (MITM)", "Denial of Service (DoS)", "SQL Injection"],
            "answer": "Man-in-the-Middle (MITM)",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "A Man-in-the-Middle (MITM) or On-Path attack is where the attacker secretly relays and possibly alters the communications between two parties who believe they are directly communicating with each other."
        },
        {
            "question": "What is the primary purpose of salting passwords before hashing them?",
            "options": ["To make the hash shorter", "To prevent rainbow table attacks", "To make passwords easier to remember", "To encrypt the password hash"],
            "answer": "To prevent rainbow table attacks",
            "domain": "General Security Concepts",
            "explanation": "A salt is a random value added to a password before hashing. This ensures that even identical passwords have different hashes, rendering pre-computed hash lists (rainbow tables) ineffective."
        },
        {
            "question": "Which of the following is a symmetric encryption algorithm?",
            "options": ["RSA", "ECC", "AES", "Diffie-Hellman"],
            "answer": "AES",
            "domain": "General Security Concepts",
            "explanation": "The Advanced Encryption Standard (AES) is a widely used symmetric encryption algorithm, meaning it uses the same key for both encryption and decryption. RSA, ECC, and Diffie-Hellman are all asymmetric."
        },
        {
            "question": "A company policy states that all employees must change their passwords every 90 days. This is an example of what kind of control?",
            "options": ["Technical", "Physical", "Administrative", "Corrective"],
            "answer": "Administrative",
            "domain": "Security Program Management and Oversight",
            "explanation": "Administrative controls are organizational policies, procedures, and standards that dictate how security is managed. A password expiration policy is a classic example."
        },
        {
            "question": "Which type of firewall filters traffic based on session information and connection state?",
            "options": ["Packet-filtering", "Stateful inspection", "Application-layer", "Proxy"],
            "answer": "Stateful inspection",
            "domain": "Security Architecture",
            "explanation": "A stateful inspection firewall monitors the state of active connections and uses this information to determine which network packets to allow through the firewall."
        },
        {
            "question": "Which security principle suggests that a system should be secure by default?",
            "options": ["Least privilege", "Fail-safe defaults", "Defense in depth", "Open design"],
            "answer": "Fail-safe defaults",
            "domain": "Security Architecture",
            "explanation": "Fail-safe defaults means that unless a subject is explicitly granted access to an object, access should be denied. It ensures that the default configuration is a secure one."
        },
        {
            "question": "An unauthorized access point is configured to mimic a legitimate corporate network to trick users into connecting. What is this access point called?",
            "options": ["Honeypot", "Rogue AP", "Evil Twin", "Ad hoc network"],
            "answer": "Evil Twin",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "An evil twin is a fraudulent Wi-Fi access point that appears to be legitimate but is set up to eavesdrop on wireless communications."
        },
        {
            "question": "What is the term for an attack that exploits a previously unknown vulnerability?",
            "options": ["Zero-day attack", "Replay attack", "Buffer overflow", "Brute-force attack"],
            "answer": "Zero-day attack",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "A zero-day attack occurs on the same day a vulnerability is discovered by the vendor, meaning no patch is available, leaving systems vulnerable."
        },
        {
            "question": "Which of the following provides integrity for a message?",
            "options": ["AES", "RSA", "SHA-256", "WPA3"],
            "answer": "SHA-256",
            "domain": "General Security Concepts",
            "explanation": "Hashing algorithms like SHA-256 produce a fixed-size hash value from input data. Any change to the data will result in a different hash, thus providing data integrity."
        },
        {
            "question": "A company wants to outsource its IT infrastructure, including servers, storage, and networking, to a cloud provider. Which service model should it choose?",
            "options": ["SaaS", "PaaS", "IaaS", "DaaS"],
            "answer": "IaaS",
            "domain": "Security Architecture",
            "explanation": "Infrastructure as a Service (IaaS) is a cloud computing model where a vendor provides users with access to computing resources such as servers, storage, and networking."
        },
        {
            "question": "Which of the following is used to manage and enforce policies on employees' smartphones and tablets?",
            "options": ["MDM (Mobile Device Management)", "SIEM (Security Information and Event Management)", "DLP (Data Loss Prevention)", "NAC (Network Access Control)"],
            "answer": "MDM (Mobile Device Management)",
            "domain": "Security Architecture",
            "explanation": "Mobile Device Management (MDM) software is used to monitor, manage, and secure employees' mobile devices that are used for both personal and business purposes."
        },
        {
            "question": "What is the name of an attack where the attacker sends a flood of ICMP echo request packets to a broadcast address?",
            "options": ["Ping of death", "Smurf attack", "SYN flood", "Teardrop attack"],
            "answer": "Smurf attack",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "A Smurf attack is a type of DDoS attack in which an attacker sends a large number of ICMP echo requests to a network broadcast address, all spoofed to appear as if they came from the victim's IP address."
        },
        {
            "question": "Which of the following is a physical security control?",
            "options": ["Password policy", "Mantrap", "Firewall", "Antivirus"],
            "answer": "Mantrap",
            "domain": "General Security Concepts",
            "explanation": "A mantrap is a physical security device with two sets of interlocking doors, where the first set must close before the second set opens, controlling access to a secure area."
        },
        {
            "question": "A developer is writing code and wants to prevent users from entering malicious scripts into input fields. What vulnerability is the developer trying to mitigate?",
            "options": ["SQL Injection", "Cross-Site Scripting (XSS)", "Cross-Site Request Forgery (CSRF)", "Buffer Overflow"],
            "answer": "Cross-Site Scripting (XSS)",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Preventing malicious scripts from being entered into input fields is a primary defense against Cross-Site Scripting (XSS), where attackers inject client-side scripts into web pages viewed by other users."
        },
        {
            "question": "Which type of backup strategy involves backing up all data that has changed since the last backup of any kind?",
            "options": ["Full", "Differential", "Incremental", "Snapshot"],
            "answer": "Incremental",
            "domain": "Security Operations",
            "explanation": "An incremental backup saves only the data that has changed since the last backup, whether it was a full or another incremental backup. This results in smaller, faster backups but a more complex restore process."
        },
        {
            "question": "Which of the following describes the 'A' in the CIA triad?",
            "options": ["Authentication", "Authorization", "Availability", "Accounting"],
            "answer": "Availability",
            "domain": "General Security Concepts",
            "explanation": "The CIA triad stands for Confidentiality, Integrity, and Availability. Availability ensures that data and services are accessible to authorized users when needed."
        },
        {
            "question": "A security team is performing a test where they have no prior knowledge of the target system. What type of test is this?",
            "options": ["White-box", "Gray-box", "Black-box", "Red team"],
            "answer": "Black-box",
            "domain": "Security Operations",
            "explanation": "In a black-box penetration test, the tester has no prior knowledge of the target system's internal workings. They must approach the test from an external attacker's perspective."
        },
        {
            "question": "What is the process of verifying a user's identity?",
            "options": ["Authorization", "Authentication", "Accounting", "Auditing"],
            "answer": "Authentication",
            "domain": "General Security Concepts",
            "explanation": "Authentication is the process of confirming a user's identity to ensure they are who they claim to be. Authorization, which happens after authentication, is the process of granting access to resources."
        },
        {
            "question": "An attacker spoofs the MAC address of a trusted device to gain access to a network. This is an example of:",
            "options": ["ARP poisoning", "MAC flooding", "IP spoofing", "DNS poisoning"],
            "answer": "ARP poisoning",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "ARP poisoning (or MAC spoofing) is an attack where an attacker sends falsified ARP messages over a local area network. This links an attacker's MAC address with the IP address of a legitimate computer or server on the network."
        },
        {
            "question": "A company wants to ensure that a single employee cannot carry out a critical task alone. Which security principle should be implemented?",
            "options": ["Least privilege", "Separation of duties", "Job rotation", "Need-to-know"],
            "answer": "Separation of duties",
            "domain": "Security Program Management and Oversight",
            "explanation": "Separation of duties is a security principle that prevents any single individual from having too much control, thereby reducing the risk of fraud and error. It requires that critical tasks be divided among multiple people."
        },
        {
            "question": "Which of the following is a characteristic of an advanced persistent threat (APT)?",
            "options": ["Low skill level", "Short-term objectives", "High level of resources and patience", "Targets individuals, not organizations"],
            "answer": "High level of resources and patience",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "APTs are sophisticated, long-term attacks, often sponsored by nation-states. They are characterized by their stealth, persistence, and significant resources."
        },
        {
            "question": "Which biometric authentication method is considered the most unique and difficult to forge?",
            "options": ["Fingerprint scan", "Facial recognition", "Iris scan", "Voice recognition"],
            "answer": "Iris scan",
            "domain": "General Security Concepts",
            "explanation": "Iris scanning is considered one of the most accurate and reliable biometric authentication methods due to the unique and complex patterns of the human iris, which are stable throughout a person's life."
        },
        {
            "question": "What type of social engineering attack involves an attacker sending a fraudulent email that appears to be from a legitimate source?",
            "options": ["Vishing", "Smishing", "Phishing", "Tailgating"],
            "answer": "Phishing",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Phishing is a social engineering attack that uses deceptive emails and websites to trick victims into revealing sensitive personal or financial information."
        },
        {
            "question": "In cryptography, what is a public key used for?",
            "options": ["To encrypt data that only the private key can decrypt", "To decrypt data that was encrypted with the same public key", "To create a digital signature", "To generate a symmetric key"],
            "answer": "To encrypt data that only the private key can decrypt",
            "domain": "General Security Concepts",
            "explanation": "In asymmetric cryptography, a public key is used to encrypt data, and only the corresponding private key can decrypt it. This ensures confidentiality."
        },
        {
            "question": "A company wants to monitor and filter web traffic for its employees. Which of the following would be the most suitable solution?",
            "options": ["VPN concentrator", "Web application firewall", "Proxy server", "IDS"],
            "answer": "Proxy server",
            "domain": "Security Architecture",
            "explanation": "A proxy server acts as an intermediary for requests from clients seeking resources from other servers. It can be used to filter content, log traffic, and improve performance through caching."
        },
        {
            "question": "What is the primary goal of a Business Continuity Plan (BCP)?",
            "options": ["To restore IT systems after a disaster", "To ensure critical business functions can continue during a disruption", "To investigate the cause of an incident", "To prosecute attackers"],
            "answer": "To ensure critical business functions can continue during a disruption",
            "domain": "Security Program Management and Oversight",
            "explanation": "A Business Continuity Plan (BCP) focuses on keeping essential business operations running during a disaster. A Disaster Recovery Plan (DRP), a component of BCP, focuses on restoring IT infrastructure."
        },
        {
            "question": "Which type of intrusion detection system (IDS) analyzes traffic for signatures of known attacks?",
            "options": ["Signature-based", "Anomaly-based", "Behavior-based", "Heuristic-based"],
            "answer": "Signature-based",
            "domain": "Security Operations",
            "explanation": "A signature-based IDS (also known as misuse-detection IDS) compares network traffic against a database of known attack patterns (signatures). It is effective against known threats but cannot detect new attacks."
        },
        {
            "question": "A user receives a text message with a malicious link. This is an example of what type of attack?",
            "options": ["Phishing", "Vishing", "Smishing", "Spear phishing"],
            "answer": "Smishing",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Smishing is a form of phishing that uses mobile phone text messages (SMS) to trick victims into clicking malicious links or revealing sensitive information."
        },
        {
            "question": "Which of the following policies specifies how employees should handle sensitive company data?",
            "options": ["Acceptable Use Policy (AUP)", "Information Classification Policy", "Password Policy", "Incident Response Policy"],
            "answer": "Information Classification Policy",
            "domain": "Security Program Management and Oversight",
            "explanation": "An information classification policy provides a framework for categorizing data based on its sensitivity (e.g., Public, Internal, Confidential) and defines handling requirements for each level."
        },
        {
            "question": "Which deployment model requires a company to purchase and own the device, but allows the user to select the device they prefer?",
            "options": ["BYOD", "COPE", "CYOD", "VDI"],
            "answer": "CYOD",
            "domain": "Security Architecture",
            "explanation": "In a Choose Your Own Device (CYOD) model, the company owns and manages the device, but the employee can choose from a pre-approved list of devices, offering a balance between user preference and corporate control."
        },
        {
            "question": "A security operations center (SOC) has identified an ongoing denial-of-service attack against their primary web server. Which of the following should be the IMMEDIATE next step?",
            "options": ["Perform a full backup of the web server", "Contact law enforcement", "Isolate the web server from the network", "Analyze the server logs to identify the attack source"],
            "answer": "Isolate the web server from the network",
            "domain": "Security Operations",
            "explanation": "The immediate priority during an active attack is containment. Isolating the server prevents the attack from potentially spreading or causing further damage to other network resources."
        },
        {
            "question": "Which of the following is a detective security control?",
            "options": ["Firewall", "Encryption", "Security guard", "Log monitoring"],
            "answer": "Log monitoring",
            "domain": "Security Program Management and Oversight",
            "explanation": "Detective controls are used to identify and record security incidents that have already occurred. Log monitoring and analysis are key detective activities."
        },
        {
            "question": "Which of the following is an example of a watering hole attack?",
            "options": ["An attacker sends a phishing email to all employees of a company", "An attacker compromises a website frequently visited by a specific group of users", "An attacker sets up a fake wireless access point in a coffee shop", "An attacker calls an employee pretending to be from the IT department"],
            "answer": "An attacker compromises a website frequently visited by a specific group of users",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "In a watering hole attack, the attacker compromises a legitimate website that they know their target group frequents, and then infects visitors from that group."
        },
        {
            "question": "A company wants to ensure that data in transit is protected from eavesdropping. Which technology should be used?",
            "options": ["Hashing", "Digital signatures", "TLS", "Steganography"],
            "answer": "TLS",
            "domain": "Security Architecture",
            "explanation": "Transport Layer Security (TLS), and its predecessor SSL, are cryptographic protocols that provide secure communication over a computer network, encrypting data in transit."
        },
        {
            "question": "A system administrator has configured a new server and wants to ensure it has the correct security settings before deploying it to the production network. What should the administrator use?",
            "options": ["Vulnerability scanner", "Configuration baseline", "Honeypot", "Penetration test"],
            "answer": "Configuration baseline",
            "domain": "Security Operations",
            "explanation": "A configuration baseline is a standardized level of security settings that should be applied to all similar systems. The administrator should compare the new server against this baseline."
        },
        {
            "question": "Which of the following is a common vector for ransomware infections?",
            "options": ["Phishing emails", "DDoS attacks", "SQL injection", "Man-in-the-middle attacks"],
            "answer": "Phishing emails",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Phishing emails with malicious attachments or links are one of the most common and effective delivery mechanisms for ransomware."
        },
        {
            "question": "Which authentication factor is a user's fingerprint an example of?",
            "options": ["Something you know", "Something you have", "Something you are", "Somewhere you are"],
            "answer": "Something you are",
            "domain": "General Security Concepts",
            "explanation": "Biometric data, such as a fingerprint, iris scan, or facial recognition, is classified as the 'something you are' authentication factor."
        },
        {
            "question": "What is the purpose of a Faraday cage?",
            "options": ["To block electromagnetic fields", "To prevent unauthorized physical access", "To provide redundant power", "To suppress fires"],
            "answer": "To block electromagnetic fields",
            "domain": "Security Architecture",
            "explanation": "A Faraday cage is an enclosure used to block electromagnetic fields (EMF). In security, it can be used to prevent wireless signals from entering or leaving a secure area, thus preventing eavesdropping and data leakage."
        },
        {
            "question": "A security analyst is reviewing logs and notices a large number of failed login attempts from a single IP address. This could be an indication of what type of attack?",
            "options": ["Phishing", "Brute-force", "Denial-of-service", "Cross-site scripting"],
            "answer": "Brute-force",
            "domain": "Security Operations",
            "explanation": "A brute-force attack involves systematically trying all possible combinations of passwords for a given username. A high volume of failed logins from one source is a strong indicator of this activity."
        },
        {
            "question": "Which of the following is the BEST way to protect against tailgating?",
            "options": ["Security guards and mantraps", "CCTV cameras", "Biometric locks", "Employee training"],
            "answer": "Security guards and mantraps",
            "domain": "General Security Concepts",
            "explanation": "Tailgating is a physical security breach. While training helps, the most effective preventative controls are physical ones like mantraps that only allow one person through at a time, or security guards who verify credentials."
        },
        {
            "question": "Which of the following cloud computing models provides a fully functional application to users over the internet?",
            "options": ["IaaS", "PaaS", "SaaS", "DaaS"],
            "answer": "SaaS",
            "domain": "Security Architecture",
            "explanation": "Software as a Service (SaaS) is a delivery model where software is licensed on a subscription basis and is centrally hosted. Users access it via a web browser, e.g., Google Docs or Office 365."
        },
        {
            "question": "An organization wants to implement a policy that requires employees to take a mandatory vacation of at least one week per year. What is the primary security benefit of this policy?",
            "options": ["It reduces employee burnout", "It helps to detect fraudulent activity", "It improves employee morale", "It is required for compliance with labor laws"],
            "answer": "It helps to detect fraudulent activity",
            "domain": "Security Program Management and Oversight",
            "explanation": "Mandatory vacation policies are a key administrative control for detecting fraud. If an employee is engaged in ongoing fraudulent activity, their absence makes it more likely that the activity will be discovered by the person covering their duties."
        },
        {
            "question": "Which of the following is a key component of a successful defense-in-depth strategy?",
            "options": ["Using a single, strong security control", "Implementing layered security controls", "Focusing only on perimeter security", "Relying on security through obscurity"],
            "answer": "Implementing layered security controls",
            "domain": "Security Architecture",
            "explanation": "Defense-in-depth is the strategy of having multiple, layered security controls. If one layer fails, another layer is already in place to protect the asset."
        },
        {
            "question": "A user is granted the minimum level of access required to perform their job duties. This is an example of which security principle?",
            "options": ["Need-to-know", "Least privilege", "Separation of duties", "Defense in depth"],
            "answer": "Least privilege",
            "domain": "General Security Concepts",
            "explanation": "The principle of least privilege dictates that a user should be given only the minimum permissions necessary to perform their job function, and no more."
        },
        {
            "question": "What type of malware is designed to steal sensitive information, such as credit card numbers and passwords, from a user's computer?",
            "options": ["Ransomware", "Spyware", "Adware", "Worm"],
            "answer": "Spyware",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Spyware is a type of malware that secretly gathers information about a person or organization and sends it to another entity. This can include login credentials, financial information, and other sensitive data."
        },
        {
            "question": "Which of the following is a common technique used in social engineering?",
            "options": ["Exploiting a software vulnerability", "Using a brute-force attack to guess a password", "Creating a sense of urgency to trick a user into taking an action", "Intercepting network traffic"],
            "answer": "Creating a sense of urgency to trick a user into taking an action",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Social engineers often manipulate human emotions. Creating a false sense of urgency (e.g., 'Your account will be suspended in one hour!') pressures the victim into making a hasty decision without thinking."
        },
        {
            "question": "A company has a policy that prohibits employees from using personal email accounts for business purposes. This is an example of what type of control?",
            "options": ["Technical", "Physical", "Administrative", "Corrective"],
            "answer": "Administrative",
            "domain": "Security Program Management and Oversight",
            "explanation": "This is an administrative (or managerial) control because it's a policy that dictates user behavior. It's not enforced by technology (technical) or a physical barrier (physical)."
        },
        {
            "question": "Which of the following is a primary benefit of using a SIEM system?",
            "options": ["To prevent intrusions from occurring", "To automatically patch software vulnerabilities", "To centralize and analyze security logs from multiple sources", "To provide a secure way for remote users to access the network"],
            "answer": "To centralize and analyze security logs from multiple sources",
            "domain": "Security Operations",
            "explanation": "A Security Information and Event Management (SIEM) system's main purpose is to aggregate log data from many sources, identify activity that deviates from the norm, and take appropriate action."
        },
        {
            "question": "What is the main purpose of a disaster recovery plan (DRP)?",
            "options": ["To ensure business continuity during a disruption", "To restore IT services and infrastructure after a disaster", "To investigate the cause of a security incident", "To comply with regulatory requirements"],
            "answer": "To restore IT services and infrastructure after a disaster",
            "domain": "Security Program Management and Oversight",
            "explanation": "While a DRP is part of overall business continuity, its specific focus is on the technical aspect of getting IT systems and services back online after a major disruption."
        },
        {
            "question": "A network administrator wants to allow HTTP traffic but block all other traffic. Which of the following firewall rules should be implemented?",
            "options": ["Allow TCP port 80, deny all others", "Deny TCP port 80, allow all others", "Allow UDP port 53, deny all others", "Deny TCP port 22, allow all others"],
            "answer": "Allow TCP port 80, deny all others",
            "domain": "Security Architecture",
            "explanation": "Firewall rules are often based on an implicit deny policy. To allow only HTTP (which uses TCP port 80), you would create a specific rule to allow that traffic and let the implicit deny rule block everything else."
        },
        {
            "question": "An organization is using a key stretching algorithm to make their password hashes more resistant to brute-force attacks. Which of the following would be an example of this type of algorithm?",
            "options": ["SHA-256", "MD5", "PBKDF2", "AES"],
            "answer": "PBKDF2",
            "domain": "General Security Concepts",
            "explanation": "PBKDF2 (Password-Based Key Derivation Function 2) is a key stretching technique designed to be computationally intensive, which slows down brute-force and dictionary attacks on password hashes."
        },
        {
            "question": "Which of the following is a primary concern when using a public Wi-Fi hotspot?",
            "options": ["Low bandwidth", "Man-in-the-middle attacks", "IP address exhaustion", "Power outages"],
            "answer": "Man-in-the-middle attacks",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Public Wi-Fi networks are often unencrypted, making it easy for attackers on the same network to intercept, eavesdrop on, or modify your traffic in a Man-in-the-Middle (On-Path) attack."
        },
        {
            "question": "A company wants to implement a system that will automatically block network traffic from known malicious IP addresses. Which of the following would be the most effective solution?",
            "options": ["Honeypot", "Intrusion Prevention System (IPS)", "Vulnerability scanner", "Log analysis server"],
            "answer": "Intrusion Prevention System (IPS)",
            "domain": "Security Operations",
            "explanation": "An Intrusion Prevention System (IPS) is a network security tool that monitors network traffic for malicious activity and can take automated action to block it, unlike an IDS which only detects and alerts."
        },
        {
            "question": "Which of the following is the most effective way to prevent SQL injection attacks?",
            "options": ["Using strong passwords for the database", "Implementing a web application firewall", "Using parameterized queries or prepared statements", "Disabling JavaScript in the browser"],
            "answer": "Using parameterized queries or prepared statements",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Using parameterized queries (or prepared statements) is a programming technique that separates the SQL command structure from the user-provided data, preventing the data from being interpreted as executable code."
        },
        {
            "question": "A company has a secure area that requires employees to swipe a badge to enter. An unauthorized person follows an employee into the secure area without swiping a badge. This is an example of:",
            "options": ["Shoulder surfing", "Tailgating", "Dumpster diving", "Vishing"],
            "answer": "Tailgating",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Tailgating (or piggybacking) is a physical security breach where an unauthorized person follows an authorized individual into a restricted area."
        },
        {
            "question": "Which of the following is an example of a preventive security control?",
            "options": ["CCTV cameras", "Log analysis", "Incident response plan", "Firewall"],
            "answer": "Firewall",
            "domain": "Security Architecture",
            "explanation": "Preventive controls are designed to stop a security incident from happening in the first place. A firewall is a classic example, as it proactively blocks unauthorized network traffic."
        },
        {
            "question": "A user's web browser is redirected to a malicious website without their knowledge. This is an example of what type of attack?",
            "options": ["Pharming", "Phishing", "Clickjacking", "Session hijacking"],
            "answer": "Pharming",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Pharming is an attack that redirects a website's traffic to another, bogus site, typically by compromising DNS servers or modifying the host file on a victim's computer."
        },
        {
            "question": "What is the purpose of a certificate revocation list (CRL)?",
            "options": ["To list all valid digital certificates", "To list all expired digital certificates", "To list all revoked digital certificates", "To list all self-signed digital certificates"],
            "answer": "To list all revoked digital certificates",
            "domain": "Security Architecture",
            "explanation": "A Certificate Revocation List (CRL) is a list of digital certificates that have been revoked by the issuing Certificate Authority (CA) before their scheduled expiration date and should no longer be trusted."
        },
        {
            "question": "Which of the following is a hashing algorithm?",
            "options": ["AES", "RSA", "SHA-512", "ECC"],
            "answer": "SHA-512",
            "domain": "General Security Concepts",
            "explanation": "SHA-512 (Secure Hash Algorithm 512-bit) is a cryptographic hash function that produces a 512-bit hash value. AES is for encryption, while RSA and ECC are asymmetric cryptographic algorithms."
        },
        {
            "question": "A company wants to ensure that employees do not share sensitive information outside of the organization via email. Which of the following technologies would be most effective in preventing this?",
            "options": ["Spam filter", "Data Loss Prevention (DLP)", "Web application firewall", "Network intrusion detection system"],
            "answer": "Data Loss Prevention (DLP)",
            "domain": "Security Operations",
            "explanation": "Data Loss Prevention (DLP) systems are designed to detect and prevent data breaches or data exfiltration transmissions. They monitor, detect, and block sensitive data while in-use, in-motion, and at-rest."
        },
        {
            "question": "Which of the following is a primary goal of a red team exercise?",
            "options": ["To test the effectiveness of an organization's security defenses", "To train employees on how to respond to security incidents", "To comply with industry regulations", "To identify and patch software vulnerabilities"],
            "answer": "To test the effectiveness of an organization's security defenses",
            "domain": "Security Operations",
            "explanation": "A red team exercise is a full-scope, multi-layered attack simulation designed to measure how well a companys people, networks, applications and physical security controls can withstand an attack from a real-life adversary."
        },
        {
            "question": "Which of the following is a common symptom of a system that has been infected with adware?",
            "options": ["The system runs slower than usual", "Files on the system are encrypted", "The user is unable to access the internet", "The system displays unwanted pop-up advertisements"],
            "answer": "The system displays unwanted pop-up advertisements",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Adware is software that generates revenue for its developer by automatically generating online advertisements in the user interface of the software or on a screen presented to the user during the installation process."
        },
        {
            "question": "A company wants to provide remote access to its employees. Which of the following technologies would provide the most secure connection?",
            "options": ["Telnet", "FTP", "VPN", "RDP"],
            "answer": "VPN",
            "domain": "Security Architecture",
            "explanation": "A Virtual Private Network (VPN) creates a secure, encrypted tunnel over a public network (like the internet), ensuring that data transmitted between the remote user and the corporate network is confidential and has integrity."
        },
        {
            "question": "Which of the following is an example of a compensating control?",
            "options": ["Implementing a firewall to protect the network perimeter", "Requiring employees to use strong passwords", "Placing a security guard at the entrance to a building", "Reviewing audit logs to detect unauthorized activity"],
            "answer": "Reviewing audit logs to detect unauthorized activity",
            "domain": "Security Program Management and Oversight",
            "explanation": "A compensating control is an alternative measure used when a primary control is not feasible. If a system cannot enforce a certain policy (a primary control), regularly reviewing audit logs for violations acts as a compensating control."
        },
        {
            "question": "An attacker is attempting to gain unauthorized access to a system by trying all possible password combinations. This is an example of what type of attack?",
            "options": ["Dictionary attack", "Brute-force attack", "Rainbow table attack", "Password spraying attack"],
            "answer": "Brute-force attack",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "A brute-force attack consists of an attacker submitting many passwords or passphrases with the hope of eventually guessing a combination correctly. The attacker systematically checks all possible passwords and passphrases until the correct one is found."
        },
        {
            "question": "A company wants to test its incident response plan to ensure that it is effective. Which of the following would be the most appropriate method?",
            "options": ["Conducting a tabletop exercise", "Performing a vulnerability scan", "Implementing a new security control", "Hiring a third-party penetration testing firm"],
            "answer": "Conducting a tabletop exercise",
            "domain": "Security Operations",
            "explanation": "A tabletop exercise is a discussion-based session where team members meet in an informal setting to discuss their roles during an emergency and their responses to a particular emergency situation. It's a perfect way to test an incident response plan without a real incident."
        },
        {
            "question": "Which of the following is the BEST way to mitigate the risk of a single point of failure in a network?",
            "options": ["Implementing a firewall", "Using strong encryption", "Implementing redundancy", "Conducting regular backups"],
            "answer": "Implementing redundancy",
            "domain": "Security Architecture",
            "explanation": "Redundancy involves duplicating critical components or functions of a system with the intention of increasing reliability of the system, usually in the form of a backup or fail-safe, or to improve actual system performance."
        },
        {
            "question": "A company is concerned about the risk of employees writing down their passwords on sticky notes. Which of the following policies would be most effective in mitigating this risk?",
            "options": ["Password complexity policy", "Clean desk policy", "Acceptable use policy", "Password rotation policy"],
            "answer": "Clean desk policy",
            "domain": "Security Program Management and Oversight",
            "explanation": "A clean desk policy requires employees to clear their desks of all sensitive information (including password sticky notes) when they leave their workspace, which directly mitigates this risk."
        },
        {
            "question": "Which of the following is an example of a threat intelligence source?",
            "options": ["A company's internal security logs", "A vendor's security advisory", "An industry information sharing and analysis center (ISAC)", "A news article about a recent data breach"],
            "answer": "An industry information sharing and analysis center (ISAC)",
            "domain": "Security Program Management and Oversight",
            "explanation": "ISACs are sector-specific organizations that gather, analyze, and disseminate cyber threat information. They are a formal source of curated threat intelligence."
        },
        {
            "question": "What is the primary purpose of a web application firewall (WAF)?",
            "options": ["To protect against network-layer attacks", "To protect against application-layer attacks such as SQL injection and XSS", "To filter spam and phishing emails", "To provide secure remote access to the network"],
            "answer": "To protect against application-layer attacks such as SQL injection and XSS",
            "domain": "Security Architecture",
            "explanation": "A WAF is specifically designed to protect web applications from common application-layer attacks by inspecting HTTP traffic between a web application and the Internet."
        },
        {
            "question": "Which of the following is a benefit of using a trusted platform module (TPM)?",
            "options": ["It provides a secure way to store cryptographic keys", "It allows for faster network speeds", "It protects against power outages", "It can be used to run virtual machines"],
            "answer": "It provides a secure way to store cryptographic keys",
            "domain": "Security Architecture",
            "explanation": "A TPM is a secure crypto-processor that is designed to carry out cryptographic operations. The module includes multiple physical security mechanisms to make it tamper-resistant, and software is not able to tamper with the security functions of the TPM."
        },
        {
            "question": "A security analyst is investigating a security incident and needs to preserve evidence from a compromised system. Which of the following should be the first step?",
            "options": ["Create a forensic image of the system's hard drive", "Shut down the system to prevent further damage", "Disconnect the system from the network", "Install antivirus software on the system"],
            "answer": "Create a forensic image of the system's hard drive",
            "domain": "Security Operations",
            "explanation": "The first step in digital forensics is to preserve the evidence in its original state. Creating a bit-for-bit forensic image of the storage media ensures that the original evidence remains untouched while the investigation proceeds on the copy."
        },
        {
            "question": "Which of the following is a common security concern associated with the Internet of Things (IoT)?",
            "options": ["Lack of strong security controls and regular patching", "High bandwidth consumption", "Limited processing power", "Physical theft of devices"],
            "answer": "Lack of strong security controls and regular patching",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Many IoT devices are shipped with default credentials, lack robust security features, and are difficult or impossible to patch, making them easy targets for attackers."
        },
        {
            "question": "A company wants to ensure that only authorized users are able to access its wireless network. Which of the following would be the most secure method?",
            "options": ["Hiding the SSID of the wireless network", "Using MAC address filtering", "Implementing WPA3-Enterprise with 802.1X authentication", "Using a pre-shared key (PSK)"],
            "answer": "Implementing WPA3-Enterprise with 802.1X authentication",
            "domain": "Security Architecture",
            "explanation": "WPA3-Enterprise combined with 802.1X provides the most robust security for wireless networks by requiring each user to authenticate individually against a central authentication server (like RADIUS), rather than using a shared password."
        },
        {
            "question": "Which of the following is an example of a detective control?",
            "options": ["A security policy that requires all employees to attend annual security awareness training", "A firewall that blocks traffic from known malicious IP addresses", "A security guard who patrols the perimeter of a building", "A log monitoring system that generates alerts for suspicious activity"],
            "answer": "A log monitoring system that generates alerts for suspicious activity",
            "domain": "Security Operations",
            "explanation": "Detective controls are designed to find and report on unwanted events that have already occurred. A log monitoring system that alerts on suspicious activity is a prime example."
        },
        {
            "question": "What is the purpose of a sandboxed environment?",
            "options": ["To run and analyze suspicious code in an isolated environment", "To store and manage cryptographic keys", "To provide a secure way for remote users to access the network", "To test the performance of a new application"],
            "answer": "To run and analyze suspicious code in an isolated environment",
            "domain": "Security Operations",
            "explanation": "A sandbox is an isolated testing environment that enables users to run programs or open files without affecting the application or system on which they run. It's often used to safely analyze malware."
        },
        {
            "question": "A company is required to comply with the Payment Card Industry Data Security Standard (PCI DSS). Which of the following is a key requirement of this standard?",
            "options": ["Encrypting all sensitive data at rest and in transit", "Conducting annual penetration tests", "Implementing a security awareness training program for all employees", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Program Management and Oversight",
            "explanation": "PCI DSS is a comprehensive standard that includes requirements for building and maintaining a secure network, protecting cardholder data (including encryption), implementing strong access control measures, and maintaining an information security policy, which includes training."
        },
        {
            "question": "Which of the following is a common indicator of a compromised system?",
            "options": ["Unusual outbound network traffic", "Increased CPU or memory usage", "Unexpected changes to system files or configurations", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Operations",
            "explanation": "All of these can be indicators of compromise (IoCs). Malware can generate unusual network traffic, consume system resources, and modify files or settings to maintain persistence."
        },
        {
            "question": "A company wants to implement a system that will allow it to remotely wipe data from lost or stolen mobile devices. Which of the following technologies would be most appropriate?",
            "options": ["Full disk encryption", "Mobile device management (MDM)", "Virtual private network (VPN)", "Data loss prevention (DLP)"],
            "answer": "Mobile device management (MDM)",
            "domain": "Security Architecture",
            "explanation": "MDM solutions provide a wide range of capabilities for managing mobile devices, including the ability to enforce security policies, locate devices, and remotely wipe data if a device is lost or stolen."
        },
        {
            "question": "Which of the following is a primary goal of a continuity of operations plan (COOP)?",
            "options": ["To ensure that an organization can continue to perform its essential functions during a disruption", "To restore IT services and infrastructure after a disaster", "To investigate the cause of a security incident", "To comply with regulatory requirements"],
            "answer": "To ensure that an organization can continue to perform its essential functions during a disruption",
            "domain": "Security Program Management and Oversight",
            "explanation": "A COOP is a plan focused on maintaining the performance of essential functions (not all functions) during a wide range of potential emergencies. It's a key part of overall business continuity."
        },
        {
            "question": "An attacker has gained access to a user's session cookie and is using it to impersonate the user. This is an example of what type of attack?",
            "options": ["Session hijacking", "Cross-site scripting (XSS)", "Cross-site request forgery (CSRF)", "Clickjacking"],
            "answer": "Session hijacking",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Session hijacking is the exploitation of a valid computer sessionsometimes also called a session keyto gain unauthorized access to information or services in a computer system."
        },
        {
            "question": "A company wants to implement a system that will provide a single point of authentication for multiple applications. Which of the following would be the most appropriate solution?",
            "options": ["Kerberos", "RADIUS", "TACACS+", "SAML"],
            "answer": "SAML",
            "domain": "Security Architecture",
            "explanation": "Security Assertion Markup Language (SAML) is an open standard for exchanging authentication and authorization data between parties, in particular, between an identity provider and a service provider. It is commonly used for web-based single sign-on (SSO)."
        },
        {
            "question": "Which of the following is a common method for exfiltrating data from a compromised network?",
            "options": ["Using DNS tunneling", "Encrypting the data and sending it via email", "Uploading the data to a cloud storage service", "All of the above"],
            "answer": "All of the above",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "Attackers use many methods to exfiltrate data. DNS tunneling hides data in DNS queries, while sending encrypted data via email or uploading to cloud services are also common, often less conspicuous, methods."
        },
        {
            "question": "A company wants to ensure that its employees are aware of the latest security threats and best practices. Which of the following would be the most effective method?",
            "options": ["Sending out a monthly security newsletter", "Requiring all employees to attend an annual security awareness training session", "Conducting regular phishing simulations", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Program Management and Oversight",
            "explanation": "A comprehensive security awareness program uses multiple methods to reinforce learning. A combination of regular training, practical simulations, and continuous communication is most effective."
        },
        {
            "question": "Which of the following is a key consideration when developing a secure software development lifecycle (SDLC)?",
            "options": ["Incorporating security into every phase of the development process", "Performing a security review of the code before it is deployed", "Conducting a penetration test of the application after it is deployed", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Program Management and Oversight",
            "explanation": "A secure SDLC involves integrating security activities throughout the entire development process, from requirements gathering and design (threat modeling) to coding (static analysis) and testing (pen testing), rather than treating security as an afterthought."
        },
        {
            "question": "A company is concerned about the risk of an attacker gaining access to its internal network by compromising a user's home computer. Which of the following would be the most effective way to mitigate this risk?",
            "options": ["Requiring all employees to use a VPN when connecting to the corporate network from home", "Providing all employees with a company-owned laptop for work purposes", "Implementing a security awareness training program that covers the risks of using home computers for work", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Architecture",
            "explanation": "A layered, defense-in-depth approach is most effective. A VPN secures the connection, a company-owned device ensures a hardened endpoint, and training addresses the human element."
        },
        {
            "question": "Which of the following is a common security risk associated with cloud computing?",
            "options": ["Misconfigured security settings", "Lack of visibility into the cloud provider's security controls", "Shared tenancy", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Architecture",
            "explanation": "All of these are significant risks. Misconfigurations by the customer are a leading cause of cloud breaches, lack of visibility can hinder incident response, and shared tenancy creates a risk of side-channel attacks."
        },
        {
            "question": "A company wants to implement a system that will allow it to track and manage changes to its IT infrastructure. Which of the following would be the most appropriate solution?",
            "options": ["A configuration management database (CMDB)", "A change management system", "A version control system", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Operations",
            "explanation": "These systems work together. A CMDB tracks assets and their configurations, a change management system provides the process for making changes, and a version control system can track the specific changes to configuration files or code."
        },
        {
            "question": "A user has received an email that appears to be from their bank, asking them to click on a link to verify their account information. This is an example of what type of attack?",
            "options": ["Spear phishing", "Whaling", "Phishing", "Vishing"],
            "answer": "Phishing",
            "domain": "Threats, Vulnerabilities, and Mitigations",
            "explanation": "This is a classic example of a phishing attack, which uses fraudulent emails to trick individuals into revealing personal information. Spear phishing is a more targeted version, and whaling targets high-profile individuals."
        },
        {
            "question": "Which of the following is a key benefit of using a bug bounty program?",
            "options": ["It allows a company to leverage the expertise of a large number of security researchers", "It can be a cost-effective way to identify and fix vulnerabilities", "It can help to improve a company's security posture and reputation", "All of the above"],
            "answer": "All of the above",
            "domain": "Security Operations",
            "explanation": "Bug bounty programs crowdsource vulnerability discovery from a global pool of researchers, providing a continuous and cost-effective way to improve security and demonstrate a commitment to it."
        }
    ]
    </script>
    <script>
        // Main script for the quiz application
        document.addEventListener('DOMContentLoaded', () => {
            // State variables
            let allQuestions = [];
            let currentQuestions = [];
            let userAnswers = [];
            let currentQuestionIndex = 0;
            let reviewQuestionIndex = 0;
            let examType = 'practice';
            let timer;
            let timeLeft = 0;
            let totalTime = 0;
            let examSeed = '';
            let startTime = 0;
            let isQuizActive = false;

            // DOM Elements
            const setupSection = document.getElementById('setup-section');
            const quizSection = document.getElementById('quiz-section');
            const resultsSection = document.getElementById('results-section');
            const reviewSection = document.getElementById('review-section');
            const startExamBtn = document.getElementById('start-exam');
            const domainSelect = document.getElementById('domain-select');
            const questionCountSelect = document.getElementById('question-count');
            const examTypeSelect = document.getElementById('exam-type');
            const questionContainer = document.getElementById('question-container');
            const reviewContainer = document.getElementById('review-container');
            const prevQuestionBtn = document.getElementById('prev-question');
            const nextQuestionBtn = document.getElementById('next-question');
            const submitExamBtn = document.getElementById('submit-exam');
            const timerDisplay = document.getElementById('timer');
            const scoreDisplay = document.getElementById('score');
            const percentageDisplay = document.getElementById('percentage');
            const timeTakenDisplay = document.getElementById('time-taken');
            const restartExamBtn = document.getElementById('restart-exam');
            const reviewExamBtn = document.getElementById('review-exam');
            const historyTableBody = document.getElementById('history-table-body');
            const downloadCsvBtn = document.getElementById('download-csv');
            const downloadJsonBtn = document.getElementById('download-json');
            const resetHistoryBtn = document.getElementById('reset-history');
            const supportIcon = document.getElementById('support-icon');
            const supportModal = document.getElementById('support-modal');
            const skipSupportBtn = document.getElementById('skip-support');
            const progressIndicator = document.getElementById('progress-indicator');
            const reviewProgressIndicator = document.getElementById('review-progress-indicator');
            const resetModal = document.getElementById('reset-modal');
            const confirmResetBtn = document.getElementById('confirm-reset-btn');
            const cancelResetBtn = document.getElementById('cancel-reset-btn');
            const loaderOverlay = document.getElementById('loader-overlay');
            const prevReviewBtn = document.getElementById('prev-review-question');
            const nextReviewBtn = document.getElementById('next-review-question');
            const backToResultsBtn = document.getElementById('back-to-results');
            
            // --- INITIAL SETUP ---
            
            function loadQuestions() {
                const questionsDataElement = document.getElementById('questions-data');
                allQuestions = JSON.parse(questionsDataElement.textContent);
                populateDomains();
            }

            function populateDomains() {
                const domains = [...new Set(allQuestions.map(q => q.domain))];
                domains.sort().forEach(domain => {
                    const option = document.createElement('option');
                    option.value = domain;
                    option.textContent = domain;
                    domainSelect.appendChild(option);
                });
            }

            // --- SEED-BASED PRNG ---
            function xmur3(str) {
                for(var i = 0, h = 1779033703 ^ str.length; i < str.length; i++) {
                    h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
                    h = h << 13 | h >>> 19;
                }
                return function() {
                    h = Math.imul(h ^ h >>> 16, 2246822507);
                    h = Math.imul(h ^ h >>> 13, 3266489909);
                    return (h ^= h >>> 16) >>> 0;
                }
            }
            
            function mulberry32(a) {
                return function() {
                  var t = a += 0x6D2B79F5;
                  t = Math.imul(t ^ t >>> 15, t | 1);
                  t ^= t + Math.imul(t ^ t >>> 7, t | 61);
                  return ((t ^ t >>> 14) >>> 0) / 4294967296;
                }
            }

            function shuffleArray(array, seed) {
                const seedFunc = xmur3(seed);
                const rand = mulberry32(seedFunc());
                let currentIndex = array.length, randomIndex;
                while (currentIndex != 0) {
                    randomIndex = Math.floor(rand() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
                }
                return array;
            }

            function generateSeed() {
                return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
            }

            // --- EXAM LOGIC ---

            function beginExam() {
                loaderOverlay.classList.remove('hidden');
                
                setTimeout(() => {
                    const selectedDomain = domainSelect.value;
                    let questionsForQuiz = allQuestions;
                    
                    if (selectedDomain !== 'all') {
                        questionsForQuiz = allQuestions.filter(q => q.domain === selectedDomain);
                    }

                    const numQuestions = Math.min(parseInt(questionCountSelect.value), questionsForQuiz.length);
                    examType = examTypeSelect.value;
                    examSeed = generateSeed();
                    
                    const shuffledQuestions = shuffleArray([...questionsForQuiz], examSeed);
                    currentQuestions = shuffledQuestions.slice(0, numQuestions);
                    
                    userAnswers = new Array(currentQuestions.length).fill(null);
                    currentQuestionIndex = 0;
                    isQuizActive = true;
                    
                    setupSection.classList.add('hidden');
                    resultsSection.classList.add('hidden');
                    reviewSection.classList.add('hidden');
                    quizSection.classList.remove('hidden');
                    supportIcon.classList.add('hidden');

                    if (examType === 'timed') {
                        timeLeft = numQuestions * 60;
                        totalTime = timeLeft;
                        startTimer();
                    } else {
                        startTime = Date.now();
                        timerDisplay.textContent = 'Practice Mode';
                    }

                    displayQuestion();
                    loaderOverlay.classList.add('hidden');
                }, 500); // Simulate loading
            }
            
            function displayQuestion() {
                if (currentQuestionIndex >= currentQuestions.length) return;
                const question = currentQuestions[currentQuestionIndex];
                let optionsHtml = '';
                
                question.options.forEach((option, index) => {
                    const isSelected = userAnswers[currentQuestionIndex] === option;
                    optionsHtml += `
                        <div class="quiz-option p-4 border rounded-lg cursor-pointer mb-3 ${isSelected ? 'selected' : 'bg-gray-50'}" data-option-index="${index}">
                           <span class="font-bold mr-2">${index + 1}.</span> ${option}
                        </div>
                    `;
                });
                
                questionContainer.innerHTML = `
                    <h3 class="text-2xl font-semibold mb-4">${currentQuestionIndex + 1}. ${question.question}</h3>
                    <div id="options-container">${optionsHtml}</div>
                `;
                
                updateQuizNavigation();
                updateProgress();

                document.querySelectorAll('.quiz-option').forEach(el => {
                    el.addEventListener('click', (e) => handleOptionSelect(e.currentTarget));
                });
            }

            function handleOptionSelect(selectedElement) {
                const selectedIndex = parseInt(selectedElement.dataset.optionIndex);
                const selectedOption = currentQuestions[currentQuestionIndex].options[selectedIndex];
                userAnswers[currentQuestionIndex] = selectedOption;
                displayQuestion();
            }

            function updateProgress() {
                progressIndicator.textContent = `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
                if (currentQuestionIndex + 1 === Math.ceil(currentQuestions.length / 2) && currentQuestionIndex > 0) {
                    showSupportModal(false);
                }
            }

            function updateQuizNavigation() {
                prevQuestionBtn.disabled = currentQuestionIndex === 0;
                prevQuestionBtn.classList.toggle('opacity-50', prevQuestionBtn.disabled);
                nextQuestionBtn.textContent = userAnswers[currentQuestionIndex] === null ? 'Skip' : 'Next';
                
                if (currentQuestionIndex === currentQuestions.length - 1) {
                    nextQuestionBtn.classList.add('hidden');
                    submitExamBtn.classList.remove('hidden');
                } else {
                    nextQuestionBtn.classList.remove('hidden');
                    submitExamBtn.classList.add('hidden');
                }
            }
            
            function startTimer() {
                timerDisplay.classList.remove('hidden');
                timer = setInterval(() => {
                    timeLeft--;
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    timerDisplay.textContent = `Time Left: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        submitExam();
                    }
                }, 1000);
            }

            function submitExam() {
                clearInterval(timer);
                isQuizActive = false;
                let score = 0;
                currentQuestions.forEach((q, index) => {
                    const correctAnswers = Array.isArray(q.answer) ? q.answer : [q.answer];
                    if (correctAnswers.includes(userAnswers[index])) {
                        score++;
                    }
                });

                const percentage = currentQuestions.length > 0 ? ((score / currentQuestions.length) * 100).toFixed(2) : 0;
                let timeTakenInSeconds;

                if (examType === 'timed') {
                    timeTakenInSeconds = totalTime - timeLeft;
                } else {
                    timeTakenInSeconds = startTime > 0 ? Math.floor((Date.now() - startTime) / 1000) : 0;
                }
                
                scoreDisplay.textContent = `${score} / ${currentQuestions.length}`;
                percentageDisplay.textContent = `${percentage}%`;
                timeTakenDisplay.textContent = formatTime(timeTakenInSeconds);
                
                saveHistory(score, percentage, timeTakenInSeconds);

                quizSection.classList.add('hidden');
                resultsSection.classList.remove('hidden');
                supportIcon.classList.remove('hidden');
                
                showSupportModal(false);
            }

            // --- REVIEW LOGIC ---
            function startReview() {
                reviewQuestionIndex = 0;
                resultsSection.classList.add('hidden');
                reviewSection.classList.remove('hidden');
                displayReviewQuestion();
            }
            
            function displayReviewQuestion() {
                const question = currentQuestions[reviewQuestionIndex];
                const userAnswer = userAnswers[reviewQuestionIndex];
                const correctAnswers = Array.isArray(question.answer) ? question.answer : [question.answer];
                let optionsHtml = '';
                
                question.options.forEach(option => {
                    let classes = 'quiz-option p-4 border rounded-lg mb-3';
                    const isCorrect = correctAnswers.includes(option);
                    const isUserChoice = userAnswer === option;
                    
                    if(isCorrect) {
                        classes += ' correct-answer';
                    }
                    if(isUserChoice && !isCorrect) {
                        classes += ' incorrect-answer';
                    }
                    if(isUserChoice) {
                        classes += ' user-selected';
                    }

                    optionsHtml += `<div class="${classes}">${option}</div>`;
                });

                reviewContainer.innerHTML = `
                    <h3 class="text-2xl font-semibold mb-4">${reviewQuestionIndex + 1}. ${question.question}</h3>
                    <div id="review-options-container">${optionsHtml}</div>
                    <div class="explanation-box">
                        <h4 class="font-bold text-lg mb-2">Explanation:</h4>
                        <p>${question.explanation}</p>
                    </div>
                `;
                updateReviewNavigation();
            }

            function updateReviewNavigation() {
                reviewProgressIndicator.textContent = `Question ${reviewQuestionIndex + 1} of ${currentQuestions.length}`;
                prevReviewBtn.disabled = reviewQuestionIndex === 0;
                prevReviewBtn.classList.toggle('opacity-50', prevReviewBtn.disabled);
                nextReviewBtn.disabled = reviewQuestionIndex === currentQuestions.length - 1;
                nextReviewBtn.classList.toggle('opacity-50', nextReviewBtn.disabled);
            }

            // --- UTILITIES & HISTORY ---

            function formatTime(totalSeconds) {
                if (isNaN(totalSeconds) || totalSeconds < 0) return '00:00:00';
                const hours = Math.floor(totalSeconds / 3600).toString().padStart(2, '0');
                const minutes = Math.floor((totalSeconds % 3600) / 60).toString().padStart(2, '0');
                const seconds = (totalSeconds % 60).toString().padStart(2, '0');
                return `${hours}:${minutes}:${seconds}`;
            }

            function saveHistory(score, percentage, timeInSeconds) {
                const history = JSON.parse(localStorage.getItem('quizHistory')) || [];
                const now = new Date();
                const newRecord = {
                    seed: examSeed,
                    date: now.toLocaleDateString(),
                    time: now.toLocaleTimeString(),
                    score: `${score} / ${currentQuestions.length}`,
                    percentage: `${percentage}%`,
                    timeTaken: formatTime(timeInSeconds)
                };
                history.unshift(newRecord);
                localStorage.setItem('quizHistory', JSON.stringify(history));
                loadHistory();
            }

            function loadHistory() {
                const history = JSON.parse(localStorage.getItem('quizHistory')) || [];
                historyTableBody.innerHTML = '';
                if (history.length === 0) {
                    historyTableBody.innerHTML = '<tr><td colspan="5" class="text-center py-4">No exam history found.</td></tr>';
                } else {
                    history.forEach(record => {
                        const row = `
                            <tr>
                                <td class="py-2 px-4 border-b">${record.seed}</td>
                                <td class="py-2 px-4 border-b">${record.date} ${record.time}</td>
                                <td class="py-2 px-4 border-b">${record.score}</td>
                                <td class="py-2 px-4 border-b">${record.percentage}</td>
                                <td class="py-2 px-4 border-b">${record.timeTaken}</td>
                            </tr>`;
                        historyTableBody.innerHTML += row;
                    });
                }
            }
            
            function downloadData(data, filename, type) {
                const blob = new Blob([data], { type });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            function showSupportModal(startAfter = true) {
                supportModal.classList.remove('hidden');
                if (startAfter) {
                    skipSupportBtn.textContent = 'Skip to Exam';
                    skipSupportBtn.onclick = () => {
                        supportModal.classList.add('hidden');
                        beginExam();
                    };
                } else {
                     skipSupportBtn.textContent = 'Close';
                     skipSupportBtn.onclick = () => supportModal.classList.add('hidden');
                }
            }
            
            // --- EVENT LISTENERS ---
            startExamBtn.addEventListener('click', () => { showSupportModal(); });
            restartExamBtn.addEventListener('click', () => {
                resultsSection.classList.add('hidden');
                setupSection.classList.remove('hidden');
            });

            // Quiz Navigation
            nextQuestionBtn.addEventListener('click', () => {
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                }
            });
            prevQuestionBtn.addEventListener('click', () => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayQuestion();
                }
            });
            submitExamBtn.addEventListener('click', submitExam);

            // Review Navigation
            reviewExamBtn.addEventListener('click', startReview);
            nextReviewBtn.addEventListener('click', () => {
                if (reviewQuestionIndex < currentQuestions.length - 1) {
                    reviewQuestionIndex++;
                    displayReviewQuestion();
                }
            });
            prevReviewBtn.addEventListener('click', () => {
                if (reviewQuestionIndex > 0) {
                    reviewQuestionIndex--;
                    displayReviewQuestion();
                }
            });
            backToResultsBtn.addEventListener('click', () => {
                reviewSection.classList.add('hidden');
                resultsSection.classList.remove('hidden');
            });
            
            // History Listeners
            resetHistoryBtn.addEventListener('click', () => { resetModal.classList.remove('hidden'); });
            cancelResetBtn.addEventListener('click', () => { resetModal.classList.add('hidden'); });
            confirmResetBtn.addEventListener('click', () => {
                localStorage.removeItem('quizHistory');
                loadHistory();
                resetModal.classList.add('hidden');
            });
            downloadJsonBtn.addEventListener('click', () => {
                const history = localStorage.getItem('quizHistory') || '[]';
                downloadData(history, 'quiz_history.json', 'application/json');
            });
            downloadCsvBtn.addEventListener('click', () => {
                const history = JSON.parse(localStorage.getItem('quizHistory')) || [];
                if (history.length === 0) return;
                const headers = Object.keys(history[0]).join(',');
                const rows = history.map(record => Object.values(record).join(',')).join('\n');
                downloadData(`${headers}\n${rows}`, 'quiz_history.csv', 'text/csv');
            });

            // Keyboard and Window Listeners
            window.addEventListener('beforeunload', (e) => {
                if (isQuizActive) {
                    e.preventDefault();
                    e.returnValue = '';
                }
            });
            document.addEventListener('keydown', (e) => {
                if (!isQuizActive) return;
                if (e.key === 'ArrowRight') nextQuestionBtn.click();
                if (e.key === 'ArrowLeft') prevQuestionBtn.click();
                if(['1','2','3','4'].includes(e.key)) {
                    const optionElement = document.querySelector(`.quiz-option[data-option-index="${parseInt(e.key) - 1}"]`);
                    if(optionElement) handleOptionSelect(optionElement);
                }
            });

            // --- INITIALIZATION ---
            loadQuestions();
            loadHistory();
        });
    </script>
</body>
</html>
